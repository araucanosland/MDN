@{
    ViewBag.Title = "Ingreso";
    Layout = "~/Areas/AppPage/Views/Shared/_Layout.cshtml";
}

<!--Masked Input [ OPTIONAL ]-->
<script src="~/Assets/plugins/masked-input/jquery.maskedinput.min.js"></script>
<!--Magic Checkbox [ OPTIONAL ]-->
<link href="~/Assets/plugins/magic-check/css/magic-check.min.css" rel="stylesheet">

<link href="~/Assets/plugins/bootstrap-validator/bootstrapValidator.min.css" rel="stylesheet">
<!--Bootstrap Select [ OPTIONAL ]-->
<link href="~/Assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet">
<style>
    div.list-group {
        height: 150px;
        overflow: scroll;
    }

    .badge-success {
        background-color: #00bcd4 !important;
    }
</style>

<!--Page content-->
<!--===================================================-->
<div id="page-content">


    <div class="row">
        <div class="col-lg-12">

            <div class="panel">
                <div class="panel-heading">
                    <div class="panel-control">
                        <i class="fa fa-thumbs-o-up fa-lg fa-fw"></i>


                    </div>
                    <h3 class="panel-title">
                        <label id="NombreAfiliado" style="font-weight:bold; color:#00bcd4"></label>&nbsp;&nbsp;<span class="label label-info" id="cumpleanos" style="display:none">Cumpleaños</span>&nbsp;&nbsp;<span class="label label-purple" id="afinuevo" style="display:none;">Afi Nuevo</span>&nbsp;&nbsp;<span class="label" id="afiVigente"></span>&nbsp;&nbsp;<span class="label" id="afiFallecido" style="display:none"></span>
                    </h3>
                </div>

                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-4">
                            <div>
                                <div class="col-sm-2">


                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">RUT:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*   <h5><label class="control-label" id="RutAfiliado">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="RutAfiliado" id="RutAfiliado" readonly="readonly" style="font-weight:bold" />

                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Empresa:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <select id="slRutEmpresa" name="slRutEmpresa" class="form-control text-dark" style="font-weight:bold"></select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Fecha Nacimiento:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*<h5><label class="control-label" id="FDNAfiliado">Sin Información</label>&nbsp;(<label class="control-label" id="AniosAfiliado"></label>&nbsp;Años)</h5>*@
                                <input type="text" class="control-label text-dark" name="FDNAfiliado" id="FDNAfiliado" readonly="readonly" style="font-weight: bold;" />
                                <div class="label label-table label-success" style="display:none">Cumpleaños</div>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Rut:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*  <h5><label class="control-label" id="NombreEmpresaAfi">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="NombreEmpresaAfi" id="NombreEmpresaAfi" readonly="readonly" style="font-weight: bold;" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Celular:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*<h5><label class="control-label" id="CelAfiliado">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="CelAfiliado" id="CelAfiliado" readonly="readonly" style="font-weight: bold;" />
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Segmento:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @* <h5><label class="control-label" id="SegmentoAfi">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="SegmentoAfi" id="SegmentoAfi" readonly="readonly" style="font-weight: bold;" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Fono Fijo:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*<h5><label class="control-label" id="FonoAfiliado">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="FonoAfiliado" id="FonoAfiliado" readonly="readonly" style="font-weight: bold;" />
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Renta:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*<h5>$<label class="control-label" id="RentaAfiliado">Sin Información</label>&nbsp;(<label class="control-label" id="RentaAfiPeriodo"></label>&nbsp;Última Informada)</h5>*@
                                <span class="control-label text-dark" style="font-weight: bold;">$</span><input type="text" class="control-label text-dark" name="RentaAfiliado" id="RentaAfiliado" readonly="readonly" style="font-weight: bold;" />&nbsp;<span class="control-label text-dark" style="font-weight: bold;">(</span><label class="control-label text-dark" style="font-weight: bold;" id="RentaAfiPeriodo"></label>&nbsp;<span class="control-label text-dark" style="font-weight: bold;">&Uacute;ltima Informada)</span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Email:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*<h5><label class="control-label" id="EmailAfiliado">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="EmailAfiliado" id="EmailAfiliado" readonly="readonly" style="font-weight: bold;" />
                            </div>
                        </div>


                        <div class="col-sm-2">
                            <div class="form-group">
                                <h5><label class="control-label">Afiliado Desde:</label></h5>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                @*<h5><label class="control-label" id="OrigenAfiliado">Sin Información</label></h5>*@
                                <input type="text" class="control-label text-dark" name="OrigenAfiliado" id="OrigenAfiliado" readonly="readonly" style="font-weight: bold;" />
                            </div>
                        </div>
                    </div>
                    <div class="row">

                    </div>

                </div>



            </div>

        </div>



    </div>


    <div class="row">


        <div class="col-sm-12">


            <div class="panel">

                <!--Panel heading-->
                <div class="panel-heading">
                    <div class="panel-control" style="float:left;">
                        <ul class="nav nav-tabs tabs-left">
                            <li class="active">
                                <a data-toggle="tab" href="#demo-lft-tab-1" aria-expanded="true" id="tab_comercial" class="tab-principal" style="font-weight: bold;">Campa&ntilde;as <span class="badge badge-success" id="cantCamp"></span></a>
                            </li>
                            <li class="">
                                <a data-toggle="tab" href="#demo-lft-tab-2" aria-expanded="false" id="tab_alertas" class="tab-principal" style="font-weight: bold;">Alertas<span class="badge badge-success" id="cantAlertas"></span></a>
                            </li>
                            @*<li class="">
                                    <a data-toggle="tab" href="#demo-lft-tab-3" aria-expanded="false" id="tab_alertas" class="tab-principal" style="font-weight: bold;">Contactibilidad<span class="badge badge-success" id="cantAlertas"></span></a>
                                </li>*@
                        </ul>
                    </div>
                    <h3 class="panel-title" style="color:white">.</h3>
                </div>

                <!--Panel body-->
                <div class="panel-body">
                    <div class="tab-content">
                        <div id="demo-lft-tab-1" class="tab-pane fade active in">
                            <div class="panel-body">
                                <div class="row">
                                    <table class="table table-hover table-vcenter">
                                        <thead>
                                            <tr>
                                                <th>Tipo Campa&ntilde;a</th>
                                                <th>Monto </th>
                                                <th>Estado</th>
                                                <th>Sub Estado</th>
                                                <th>Fecha Compromete</th>
                                                <th>Prioridad</th>

                                            </tr>
                                        </thead>
                                        <tbody id="bdy_datos"></tbody>
                                    </table>
                                </div>

                            </div>
                        </div>

                        <div id="demo-lft-tab-2" class="tab-pane fade">
                            <div class="panel-body">
                                <div class="row">
                                    <table class="table table-hover table-vcenter">
                                        <thead>
                                            <tr>

                                                <th>Descripci&oacute;n</th>
                                                <th>Valor</th>
                                            </tr>
                                        </thead>
                                        <tbody id="bdy_datosAlertas"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        @*<div id="demo-lft-tab-3" class="tab-pane fade">
                            <div class="panel-body">
                                <div class="col-lg-6">
                                    <div id="demo-carousel" class="carousel slide" data-ride="carousel">

                                        <!--Indicators-->
                                        <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
                                        <ol class="carousel-indicators out">
                                            <li class="" data-slide-to="0" data-target="#demo-carousel"></li>
                                            <li data-slide-to="1" data-target="#demo-carousel" class=""></li>
                                            <li data-slide-to="2" data-target="#demo-carousel" class="active"></li>
                                        </ol>
                                        <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

                                        <div class="carousel-inner text-center">

                                            <!--Item 1-->
                                            <div class="item">
                                                <h4 class="text-main">First slide label</h4>
                                                <p>Nulla vitae elit libero, a pharetra augue mollis interdum.</p>
                                            </div>

                                            <!--Item 2-->
                                            <div class="item">
                                                <h4 class="text-main">Second slide label</h4>
                                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                                            </div>

                                            <!--Item 3-->
                                            <div class="item active">
                                                <h4 class="text-main">Third slide label</h4>
                                                <p>Praesent commodo cursus magna, vel scelerisque nisl consectetur.</p>
                                            </div>
                                        </div>

                                        <!--carousel-control-->
                                        <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
                                        <a class="carousel-control left" data-slide="prev" href="#demo-carousel"><i class="demo-pli-arrow-left icon-2x"></i></a>
                                        <a class="carousel-control right" data-slide="next" href="#demo-carousel"><i class="demo-pli-arrow-right icon-2x"></i></a>
                                        <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

                                    </div>
                                </div>
                                </div>
                            </div>*@
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="demo-lg-modal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                    <h4 class="modal-title" id="myLargeModalLabel">Gestión Comercial</h4>
                </div>
                <div>

                    <div class="tab-base" style="margin-bottom: 0px !important;">
                        <!--Nav Tabs-->
                        <ul class="nav nav-tabs">

                            <li class="active">
                                <a data-toggle="tab" href="#tab-gestion-2" aria-expanded="false">Historial de Gestión</a>
                            </li>
                            <li class="">
                                <a data-toggle="tab" href="#tab-gestion-4" aria-expanded="false">Filtros</a>
                            </li>

                        </ul>
                        <div class="tab-content" style="box-shadow: 0 0 0 !important;">
                            <div id="tab-gestion-2"  class="tab-pane  fade active in">
                                <div class="list-group" id="gestiones_realizadas">


                                </div>
                            </div>
                            <div id="tab-gestion-4" class="tab-pane fade">
                                <div class="table-responsive" style="overflow:scroll; height:150px;">
                                    <table class="table table-striped">
                                        <tbody id="letable"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Modal footer-->
                <div class="modal-footer" id="mensahes-mustPre">
                    <form id="datos-gestion" action="#" method="post">
                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">Estado</label>
                                    <select class="form-control" id="ges_estado" name="ges_estado">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">Sub Estado</label>
                                    <select class="form-control" id="ges_subestado" name="ges_subestado" disabled="disabled">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group" id="fpg">
                                    <label class="control-label">Fecha Próxima Gestión</label>
                                    <div id="demo-dp-component">
                                        <div class="input-group date">
                                            <input type="text" class="form-control" id="ges_prox_gestion" name="ges_prox_gestion">
                                            <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="control-label">Comentarios</label>
                                    <textarea placeholder="Comentarios" rows="3" class="form-control" id="ges_comentarios" name="ges_comentarios"></textarea>
                                </div>
                            </div>

                        </div>

                        <input type="hidden" id="ges_id_asignacion" name="ges_id_asignacion" value="" />

                        <button data-dismiss="modal" class="btn btn-default" type="button">Cerrar</button>
                        <button class="btn btn-primary esconder" id="btn_savear" type="submit">Guardar</button>
                    </form>


                </div>
            </div>
        </div>
    </div>
    <div id="demo-lg-modal-Normalizacion" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                    <h4 class="modal-title" id="myLargeModalLabel">Gestión Normalización</h4>
                </div>
                <div class="modal-body">

                    <div class="tab-base" style="margin-bottom: 0px !important;">
                        <!--Nav Tabs-->
                        <ul class="nav nav-tabs">

                            <li class="active">
                                <a data-toggle="tab" href="#tab-gestionNor-2" aria-expanded="false">Historial de Gestión</a>
                            </li>

                        </ul>
                        <div class="tab-content" style="box-shadow: 0 0 0 !important;">
                            <div id="tab-gestionNor-2" class="tab-pane  fade active in">
                                <div class="list-group" id="gestiones_realizadasNorm">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="mensahes-mustNor">
                    <form id="datos-gestion_normalizacion" action="#" method="post">
                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label class="control-label">Causa basal</label>
                                    <select class="form-control" id="ges_causa_basal_normalizacion" name="ges_causa_basal_normalizacion">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label class="control-label">Consecuencia</label>
                                    <select class="form-control" id="ges_consecuencia_normalizacion" name="ges_consecuencia_normalizacion">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label class="control-label">Estado</label>
                                    <select class="form-control" id="ges_estado_normalizacion" name="ges_estado_normalizacion">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-3">
                                <div class="form-group" id="fpg_normalizacion">
                                    <label class="control-label">Fecha Próxima Gestión</label>
                                    <div id="demo-dp-component_normalizacion">
                                        <div class="input-group date">
                                            <input type="text" class="form-control" id="ges_prox_gestion_normalizacion" name="ges_prox_gestion_normalizacion">
                                            <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="control-label">Comentarios</label>
                                    <textarea placeholder="Comentarios" rows="3" class="form-control" id="ges_comentarios_normalizacion" name="ges_comentarios_normalizacion"></textarea>
                                </div>
                            </div>

                        </div>

                        <input type="hidden" id="ges_id_asignacion_normalizacion" name="ges_id_asignacion_normalizacion" value="" />
                        @* <label id="ges_id_asignacion_normalizacion" name="ges_id_asignacion_normalizacion" style="display:none;"></label>*@


                        <button data-dismiss="modal" class="btn btn-default" type="button">Cerrar</button>

                        <button class="btn btn-primary esconder" id="btn_savear_normalizacion" type="submit">Guardar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="demo-lg-modal-sc" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                    <h4 class="modal-title" id="myLargeModalLabel">Gestión SC</h4>
                </div>
                <div class="modal-body">

                    <div class="tab-base" style="margin-bottom: 0px !important;">
                        <!--Nav Tabs-->
                        <ul class="nav nav-tabs">

                            <li class="active">
                                <a data-toggle="tab" href="#tab-gestionSC-2" aria-expanded="false">Historial de Gestión</a>
                            </li>

                        </ul>
                        <div class="tab-content" style="box-shadow: 0 0 0 !important;">
                            <div id="tab-gestionNor-2" class="tab-pane  fade active in">
                                <div class="list-group" id="gestiones_realizadasSC">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="mensahes-mustsc">

                    <form id="datos-gestion-sc" action="#" method="post">
                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">Estado</label>
                                    <select class="form-control" id="ges_estadoSC" name="ges_estadoSC">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">Sub Estado</label>
                                    <select class="form-control" id="ges_subestadoSC" name="ges_subestadoSC" disabled="disabled">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group" id="fpgSC">
                                    <label class="control-label">Fecha Próxima Gestión</label>
                                    <div id="demo-dp-componentSC">
                                        <div class="input-group date">
                                            <input type="text" class="form-control" id="ges_prox_gestionSC" name="ges_prox_gestionSC">
                                            <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="control-label">Comentarios</label>
                                    <textarea placeholder="Comentarios" rows="3" class="form-control" id="ges_comentariosSC" name="ges_comentariosSC"></textarea>
                                </div>
                            </div>

                        </div>

                        <input type="hidden" id="ges_id_asignacionSC" name="ges_id_asignacionSC" value="" />



                        <button data-dismiss="modal" class="btn btn-default" type="button">Cerrar</button>
                        <button class="btn btn-primary esconder" id="btn_savear" type="submit">Guardar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div id="demo-lg-modal-tmc" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                    <h4 class="modal-title" id="myLargeModalLabel">Gestión TMC</h4>
                </div>
                <div class="modal-body">

                    <div class="tab-base" style="margin-bottom: 0px !important;">
                        <!--Nav Tabs-->
                        <ul class="nav nav-tabs">

                            <li class="active">
                                <a data-toggle="tab" href="#tab-gestionTmc-2" aria-expanded="false">Historial de Gestión</a>
                            </li>

                        </ul>
                        <div class="tab-content" style="box-shadow: 0 0 0 !important;">
                            <div id="tab-gestionNor-2" class="tab-pane  fade active in">
                                <div class="list-group" id="gestiones_realizadasTMC">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="mensahes-musttmc">
                    <form id="datos-gestion-tmc" action="#" method="post">
                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">Estado</label>
                                    <select class="form-control" id="ges_estadoTMC" name="ges_estadoTMC">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">Sub Estado</label>
                                    <select class="form-control" id="ges_subestadoTMC" name="ges_subestadoTMC" disabled="disabled">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group" id="fpgTMC">
                                    <label class="control-label">Fecha Próxima Gestión</label>
                                    <div id="demo-dp-componentTMC">
                                        <div class="input-group date">
                                            <input type="text" class="form-control" id="ges_prox_gestionTMC" name="ges_prox_gestionTMC">
                                            <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row esconder" style="text-align: left;">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="control-label">Comentarios</label>
                                    <textarea placeholder="Comentarios" rows="3" class="form-control" id="ges_comentariosTMC" name="ges_comentariosTMC"></textarea>
                                </div>
                            </div>

                        </div>

                        <input type="hidden" id="ges_id_asignacionTMC" name="ges_id_asignacionTMC" value="" />
                        <input type="hidden" id="ges_oficina" name="ges_oficina" value="" />
                        <input type="hidden" id="ges_token" name="ges_token" value="" />


                        <button data-dismiss="modal" class="btn btn-default" type="button">Cerrar</button>
                        <button class="btn btn-primary esconder" id="btn_savear" type="submit">Guardar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<input type="hidden" id="temporalid" name="temporalid" value="" />
<!--===================================================-->
<!--End page content-->
@section script{

    <script src="~/Assets/plugins/fooTable/dist/footable.all.min.js"></script>
    <script src="~/Assets/plugins/bootstrap-validator/bootstrapValidator.min.js"></script>
    <!--Bootstrap Select [ OPTIONAL ]-->
    <script src="~/Assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
    <!--Bootbox Modals [ OPTIONAL ]-->
    <script src="~/Assets/plugins/bootbox/bootbox.min.js"></script>
    <!--Masked Input [ OPTIONAL ]-->
    <script src="~/Assets/plugins/masked-input/jquery.maskedinput.min.js"></script>
    <script src="~/Assets/js/jquery.rut.chileno.min.js"></script>
    <script src="~/Assets/plugins/fooTable/dist/footable.all.min.js"></script>

    <!--Bootstrap Select [ OPTIONAL ]-->


    <script type="text/javascript">
        var _temoralid = 0;
        var Cargador = {
            CargaDatosAfiliados: function (p_rut) {
                $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-info-afiliado", { RutAfiliado: p_rut }, function (e) {
                    if (e.RutAfiliado == null) {
                        $("#NombreAfiliado").html("Afiliado Sin Información");
                    }

                    else {
                        $("#RutAfiliado").val(e.RutAfiliado);
                        $("#NombreAfiliado").html(e.Nombres);
                        $("#FDNAfiliado").val(e.FechaNacimiento);
                        $("#AniosAfiliado").html(e.Edad);
                        $("#CelAfiliado").val(e.Cel);
                        $("#FonoAfiliado").val(e.Fono);
                        $("#EmailAfiliado").val(e.Mail);

                        $("#OrigenAfiliado").val(e.InicioValidezRol);
                    }
                    if (e.Vigente == 1) {
                        //$("#afiVigente").html("Afi Vigente").addClass("label-info label-info");

                    }
                    else {
                        $("#afiVigente").html("No Vigente").addClass("label-info label-danger");
                        $("#NombreAfiliado").css({ 'color': 'grey' })
                    }
                    if (e.Fallecido == 1) {
                        console.log("falledio")
                        $("#afiFallecido").show()
                        $("#afiFallecido").html("Fallecido").addClass("label-info label-danger");
                        $("#NombreAfiliado").css({ 'color': 'grey' })
                    }
                    else {
                        $("#afiFallecido").hide();
                    }
                    $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/lista-rut-empresa", { RutAfiliado: p_rut }, function (datos) {

                        $("#slRutEmpresa").html("");
                        $.each(datos, function (i, empresa) {
                            $("#slRutEmpresa").append($("<option>").val(empresa.RutEmpresa).html(empresa.NombreEmpresa));
                        });
                        $("#slRutEmpresa").trigger("change");
                    });

                });
            },
            CargaDatosCumpleanos: function (rutCumpleanos) {
                $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-cumpleanos", { RutAfiliado: rutCumpleanos }, function (e) {
                    console.log(e.Estado)
                    switch (e.Estado) {
                        case 'Cumpleaños':
                            $("#cumpleanos").show();
                            break;
                        case 'NUEVO':
                            $("#afinuevo").show();
                            break;
                    }





                });
            },
            CargaDatosCampaniasAfiliado: function (p_rutAfi) {
                $("#bdy_datos").html("");
                $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/lista-campanias-afiliado", { RutAfiliado: p_rutAfi }, function (camp) {
                    $.each(camp, function (i, e) {

                        var clase = '';
                        var link = '<a href="#" class="btn-link" data-target="#demo-lg-modal" data-toggle="modal" data-asignacion="' + e.id_Asginacion + '">' + e.Campania + '</a>';
                        switch (e.Campania) {
                            case 'Comercial':
                                clase = 'text-dark';
                                link = '<a href="#" class="btn-link" data-target="#demo-lg-modal" data-toggle="modal" data-asignacion="' + e.id_Asginacion + '">' + e.Campania + '</a>';
                                break;
                            case 'Normalización':
                                clase = 'text-dark';
                                link = '<a href="#" class="btn-link" data-target="#demo-lg-modal-Normalizacion" data-toggle="modal" data-asignacion="' + e.id_Asginacion + '">' + e.Campania + '</a>';
                                break;
                            case 'Seguro Cesantía':
                                clase = 'text-dark';
                                link = '<a href="#" class="btn-link" data-target="#demo-lg-modal-sc" data-toggle="modal" data-asignacion="' + e.id_Asginacion + '">' + e.Campania + '</a>';
                                break;
                            case 'TMC':
                                clase = 'text-dark';
                                link = '<a href="#" class="btn-link" data-target="#demo-lg-modal-tmc" data-toggle="modal" data-asignacion="' + e.id_Asginacion + '">' + e.Campania + '</a>';
                                break;
                        }

                        $("#bdy_datos")
                            .append(
                                $("<tr>")

                                   // .append($("<td>").append(e.Campania))
                                     .append($("<td>").append(link))
                                     .append($("<td>").addClass("text-dark").addClass(clase).text('$' + e.Oferta.toMoney(0)))
                                     .append($("<td>").append(e.Estado))
                                     .append($("<td>").append(e.SubEstado))
                                     .append($("<td>").append(e.FechaCompromete.toFecha() != '01-01-1753' && e.FechaCompromete.toFecha() != '01-01-0001' ? e.FechaCompromete.toFecha() : 'N/A'))
                                     .append($("<td>").append(e.Prioridad.toString().toEtiquetaPrioridadScan()))
                                    // .append($("<td>").append((e.HistorialGestion.length > 0 && e.HistorialGestion[0].GestionBase.FechaCompromete.toFecha() != '01-01-1753') ? e.HistorialGestion[0].GestionBase.FechaCompromete.toFecha() : 'N/A'))


                            );
                        $("#cantCamp").html(i + 1)
                    });


                });
            },
            CargaDatosAlertas: function (p_rutAlertas) {
                $("#bdy_datosAlertas").html("");
                $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/lista-alerta-afiliado", { RutAfiliado: p_rutAlertas }, function (menus) {
                    $.each(menus, function (i, e) {
                        var valor = '';
                        var clase = '';
                        console.log(e.TipoValor)
                        switch (e.TipoValor) {
                            case 'Moneda':
                                clase = 'text-bold';
                                valor = parseInt(e.Valor).toMoney(0);
                                break;
                            case 'Fecha':
                                clase = 'text-bold';
                                valor = e.Valor;
                                break;

                        }

                        $("#bdy_datosAlertas")
                            .append(
                                $("<tr>")
                                   .append($("<td>").append(e.Tipo))
                                   .append($("<td>").addClass("text-dark").addClass(clase).text(valor))
                            );
                        $("#cantAlertas").html(i + 1)
                    });
                });
            }


        }
        $("#slRutEmpresa").on("change", function (e) {
            $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-info-empresa", { RutEmpresa: $("#slRutEmpresa").val(), RutAfiliado: rutAf }, function (datos) {
                $("#NombreEmpresaAfi").val(datos.RutEmpresaDv);
                $("#SegmentoAfi").val(datos.RolSegmentoAfiliado);
                $("#RentaAfiliado").val(datos.RentaUltimaInformada.toMoney(0));
                $("#RentaAfiPeriodo").html(datos.PeriodoUltimaRenta);
            });
        });
        //EVENTO CHANGE
        $("#ges_estado").on("change", function () {

            if ($(this).val() != '') {
                $("#ges_subestado").attr("disabled", false);
                $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 1, padre: $(this).val() }, function (datos) {
                    $("#ges_subestado").html("");
                    $("#ges_subestado").append($("<option>").attr("value", "").html("Seleccione"));
                    //  $('#datos-gestion').bootstrapValidator('updateStatus', 'ges_subestado', 'NOT_VALIDATED').bootstrapValidator('validateField', 'ges_subestado');
                    $.each(datos, function (i, e) {
                        $("#ges_subestado").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre))
                    });
                });
                if ($(this).find("option:selected").data("terminal") == "CERRADOS" || $(this).find("option:selected").data("terminal") == "PENDIENTESNOCAL") {
                    $("#fpg").hide();
                }
                else {
                    $("#fpg").show();
                }
            }
            else {
                $("#ges_subestado").html("");
                $("#ges_subestado").attr("disabled", true);
            }
        });
        $("#ges_estadoSC").on("change", function () {

            if ($(this).val() != '') {
                $("#ges_subestadoSC").attr("disabled", false);
                $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 4, padre: $(this).val() }, function (datos) {
                    $("#ges_subestadoSC").html("");
                    $("#ges_subestadoSC").append($("<option>").attr("value", "").html("Seleccione"));
                    // $('#datos-ges_subestadoSC').bootstrapValidator('updateStatus', 'ges_subestadoSC', 'NOT_VALIDATED').bootstrapValidator('validateField', 'ges_subestadoSC');
                    $.each(datos, function (i, e) {
                        if (e.ejes_terminal != "SISTEMA") {
                            $("#ges_subestadoSC").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre))
                        }

                    });
                });


                if ($(this).find("option:selected").data("terminal") == "CERRADOS" || $(this).find("option:selected").data("terminal") == "PENDIENTESNOCAL") {
                    $("#fpgSC").hide();
                }
                else {
                    $("#fpgSC").show();
                }

            }
            else {
                $("#ges_subestadoSC").html("");
                $("#ges_subestadoSC").attr("disabled", true);
            }
        });
        $("#ges_estadoTMC").on("change", function () {

            if ($(this).val() != '') {
                $("#ges_subestadoTMC").attr("disabled", false);
                $.SecGetJSON(BASE_URL + "/CPEngine/api/camp/lista-estges-camp", { cc: 8, cp: $(this).val() }, function (datos) {
                    $("#ges_subestadoTMC").html("");
                    $("#ges_subestadoTMC").append($("<option>").attr("value", "").html("Seleccione"));
                    $('#datos-gestion-tmc').bootstrapValidator('updateStatus', 'ges_subestadoTMC', 'NOT_VALIDATED').bootstrapValidator('validateField', 'ges_subestadoTMC');
                    $.each(datos, function (i, e) {
                        console.log(e)
                        $("#ges_subestadoTMC").append($("<option>").attr("value", e.CodEstado).html(e.Nombre))
                    });
                });
                if ($(this).find("option:selected").data("terminal")) {
                    $("#fpgTMC").hide();
                }
                else {
                    $("#fpgTMC").show();
                }
            }
            else {
                $("#ges_subestadoTMC").html("");
                $("#ges_subestadoTMC").attr("disabled", true);
            }
        });
        $('#demo-dp-componentSC .input-group.date').datepicker(
               { autoclose: true, format: 'dd-mm-yyyy', startDate: "0d", language: "es", daysOfWeekDisabled: [6, 0], todayHighlight: true }
         ).on('show.bs.modal hide.bs.modal', function (event) {
             event.stopPropagation();
         });

        $('#demo-dp-componentTMC .input-group.date').datepicker(
              { autoclose: true, format: 'dd-mm-yyyy', startDate: "0d", language: "es", daysOfWeekDisabled: [6, 0], todayHighlight: true }
        ).on('show.bs.modal hide.bs.modal', function (event) {
            event.stopPropagation();
        });

        $('#demo-lg-modal').on('show.bs.modal', function (event) {

            var link = $(event.relatedTarget); // Button that triggered the modal
            var Asignacion = link.data('asignacion');
            if (typeof Asignacion != 'undefined') {
                $('#ges_id_asignacion').val(Asignacion)
            }
            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 1, padre: 0 }, function (datos) {
                $("#ges_estado").data("TipoAsignacion", 1);
                $("#ges_estado").html("");
                $("#ges_estado").append($("<option>").attr("value", "").html("Seleccione"));

                $.each(datos, function (i, e) {
                    $("#ges_estado").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre).data("terminal", e.ejes_terminal))
                });
            });
            $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-hist-tipo-campana", { RutAfiliado: rutAf, TipoAsignacion: 1 }, function (gesList) {
                $("#gestiones_realizadas").html("");
                $.each(gesList, function (i, e) {
                    $("#gestiones_realizadas")
                         .append(
                         $("<a>")
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.FechaAccion.toFechaHora() + ",<br/> <strong>Fecha Prox. Gestión:</strong> " + e.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.Estado + ",  <strong>Sub Estado:</strong> " + e.SubEstado))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.Descripcion))
                     );
                });
                if (gesList.length > 0 && gesList[0].EsTerminal === "CERRADOS") {
                    $(".esconder").hide();
                } else {
                    $(".esconder").show();
                }


            });

            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-rechazos-rsg", { Periodo: 201805, RutEmpresa: $("#slRutEmpresa").val(), RutAfiliado: rutAf }, function (datos) {

                $("#letable").html("");
                $.each(datos, function (i, e) {
                    $("#letable").append($("<tr>").append("<td>").html(e.MotivoRechazo))
                });
            });
            $('#demo-dp-component .input-group.date').datepicker(
          { autoclose: true, format: 'dd-mm-yyyy', startDate: "0d", language: "es", daysOfWeekDisabled: [6, 0], todayHighlight: true })
                        .on('show.bs.modal hide.bs.modal', function (event) {
                            // prevent datepicker from firing bootstrap modal "show.bs.modal"
                            event.stopPropagation();
                        });

        });
        $('#demo-lg-modal-Normalizacion').on('show.bs.modal', function (event) {

            var link = $(event.relatedTarget); // Button that triggered the modal
            var AsignacionNorm = link.data('asignacion');
            if (typeof AsignacionNorm != 'undefined') {
                $("#ges_id_asignacion_normalizacion").val(AsignacionNorm)
            }
            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 2, padre: 0 }, function (datos) {
                $("#ges_causa_basal_normalizacion").data("TipoAsignacion", 2);
                $("#ges_causa_basal_normalizacion").html("");
                $("#ges_causa_basal_normalizacion").append($("<option>").attr("value", "").html("Seleccione"));

                $.each(datos, function (i, e) {
                    $("#ges_causa_basal_normalizacion").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre).data("terminal", e.ejes_terminal))
                });
            });
            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 2, padre: 10 }, function (datos) {
                $("#ges_consecuencia_normalizacion").data("TipoAsignacion", 2);
                $("#ges_consecuencia_normalizacion").html("");
                $("#ges_consecuencia_normalizacion").append($("<option>").attr("value", "").html("Seleccione"));

                $.each(datos, function (i, e) {
                    $("#ges_consecuencia_normalizacion").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre).data("terminal", e.ejes_terminal))
                });
            });
            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 2, padre: 20 }, function (datos) {
                $("#ges_estado_normalizacion").data("TipoAsignacion", 2);
                $("#ges_estado_normalizacion").html("");
                $("#ges_estado_normalizacion").append($("<option>").attr("value", "").html("Seleccione"));

                $.each(datos, function (i, e) {
                    $("#ges_estado_normalizacion").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre).data("terminal", e.ejes_terminal))
                });
            });


            $('#demo-dp-component_normalizacion .input-group.date').datepicker({ autoclose: true, format: 'dd-mm-yyyy', startDate: "0d", language: "es", daysOfWeekDisabled: [6, 0], todayHighlight: true })
                   .on('show.bs.modal hide.bs.modal', function (event) {
                       // prevent datepicker from firing bootstrap modal "show.bs.modal"
                       event.stopPropagation();
                   });
            $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-hist-tipo-campana", { RutAfiliado: rutAf, TipoAsignacion: 2 }, function (gesListNor) {
                $("#gestiones_realizadasNorm").html("");
                $.each(gesListNor, function (i, e) {
                    $("#gestiones_realizadasNorm")
                         .append(
                         $("<a>")
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.Estado + ",  <strong>Sub Estado:</strong> " + e.SubEstado))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.Descripcion))
                     );
                });


            });
        });
        $('#demo-lg-modal-sc').on('show.bs.modal', function (event) {

            var link = $(event.relatedTarget); // Button that triggered the modal
            var AsignacionSC = link.data('asignacion');
            if (typeof AsignacionSC != 'undefined') {
                $("#ges_id_asignacionSC").val(AsignacionSC)
            }

            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 4, padre: 0 }, function (datos) {
                $("#ges_estadoSC").data("TipoAsignacion", 4);
                $("#ges_estadoSC").html("");
                $("#ges_estadoSC").append($("<option>").attr("value", "").html("Seleccione"));

                $.each(datos, function (i, e) {
                    $("#ges_estadoSC").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre).data("terminal", e.ejes_terminal))
                });
            });
            $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-hist-tipo-campana", { RutAfiliado: rutAf, TipoAsignacion: 4 }, function (gesListSC) {
                $("#gestiones_realizadasSC").html("");
                $.each(gesListSC, function (i, e) {
                    $("#gestiones_realizadasSC")
                         .append(
                         $("<a>")
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.Estado + ",  <strong>Sub Estado:</strong> " + e.SubEstado))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.Descripcion))
                     );
                });


            });

        });
        $('#demo-lg-modal-tmc').on('show.bs.modal', function (event) {

            var link = $(event.relatedTarget); // Button that triggered the modal
            var Asignacion = link.data('asignacion');
            if (typeof Asignacion != 'undefined') {
                $("#ges_id_asignacionTMC").val(Asignacion)
            }

            $.SecGetJSON(BASE_URL + "/CPEngine/api/camp/lista-estges-camp", { cc: 8, cp: 0 }, function (datos) {
                //$("#ges_estado").data("TipoAsignacion", afiData.TipoAsignacion);
                $("#ges_estadoTMC").html("");
                $("#ges_estadoTMC").append($("<option>").attr("value", "").html("Seleccione"));

                $.each(datos, function (i, e) {
                    $("#ges_estadoTMC").append($("<option>").attr("value", e.CodEstado).html(e.Nombre).data("terminal", e.EsTerminal))
                });
            });
            $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/obtener-hist-tipo-campana", { RutAfiliado: rutAf, TipoAsignacion: 8 }, function (gesListTMC) {
                $("#gestiones_realizadasTMC").html("");
                $.each(gesListTMC, function (i, e) {
                    $("#gestiones_realizadasTMC")
                         .append(
                         $("<a>")
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.Estado + ",  <strong>Sub Estado:</strong> " + e.SubEstado))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.Descripcion))
                     );
                });


            });

        });

        $('#datos-gestion').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                ges_estado: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un estado'
                        }
                    }
                },
                ges_subestado: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un sub estado'
                        }
                    }
                },
                ges_prox_gestion: {
                    validators: {
                        notEmpty: {
                            message: 'La fecha de próxima gestión no puede ser vacía'
                        },
                        date: {
                            format: 'DD-MM-YYYY',
                            message: 'Formato de fecha incorrecto'
                        }
                    }
                },
                ges_comentarios: {
                    validators: {
                        notEmpty: {
                            message: 'Debe agregar algún comentario'
                        },
                        stringLength: {
                            message: 'No pueden ser mas de 150 caracteres',
                            max: function (value, validator, $field) {
                                return 150 - (value.match(/\r/g) || []).length;
                            }
                        }
                    }
                },



            }
        }).on('success.form.bv', function (e) {
            // Prevén que se mande el formulario
            e.preventDefault();
            var $form = $(e.target);
            $.SecPostJSON(BASE_URL + "/motor/api/Gestion/guardar-gestion", $form.serialize(), function (respuesta) {


                $("#gestiones_realizadas").html("");
                $.each(respuesta.Objeto, function (i, e) {
                    $("#gestiones_realizadas").append($("<a>").attr("href", '#')
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Gestor.EjecutivoData.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.GestionBase.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.GestionBase.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.EstadoGestion.eges_nombre + ",  <strong>Sub Estado:</strong> " + e.SubEstadoGestion.eges_nombre))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.GestionBase.Descripcion))
                     );
                });


                if (respuesta.Objeto.length > 0 && respuesta.Objeto[0].EstadoGestion.ejes_terminal === "CERRADOS") {
                    $(".esconder").hide();
                }

                $("#datos-gestion").bootstrapValidator('resetForm', true);

                $.niftyNoty({
                    type: 'success',
                    container: '#mensahes-mustPre',
                    html: '<strong>OK</strong> Gestion guardada exitosamente.',
                    focus: false,
                    timer: 3000,
                    onHidden: function () {
                        window.location.reload(true);
                    }
                });




            });
        });

        $('#datos-gestion-sc').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            fields: {
                ges_estadoSC: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un estado'
                        }
                    }
                },
                ges_subestadoSC: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un sub estado'
                        }
                    }
                },
                ges_prox_gestionSC: {
                    validators: {
                        notEmpty: {
                            message: 'La fecha de próxima gestión no puede ser vacía'
                        },
                        date: {
                            format: 'DD-MM-YYYY',
                            message: 'Formato de fecha incorrecto'
                        }
                    }
                },
                ges_comentariosSC: {
                    validators: {
                        notEmpty: {
                            message: 'Debe agregar algún comentario'
                        },
                        stringLength: {
                            message: 'No pueden ser mas de 150 caracteres',
                            max: function (value, validator, $field) {
                                return 150 - (value.match(/\r/g) || []).length;
                            }
                        }
                    }
                },



            }
        }).on('success.form.bv', function (e) {
            // Prevén que se mande el formulario
            e.preventDefault();
            var $form = $(e.target);

            $.SecPostJSON(BASE_URL + "/motor/api/Gestion/guardar-gestion-normalizacionSC", $form.serialize(), function (respuesta) {

                $("#gestiones_realizadasSC").html("");
                $.each(respuesta.Objeto, function (i, e) {
                    $("#gestiones_realizadasSC").append($("<a>").attr("href", '#')
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Gestor.EjecutivoData.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.GestionBase.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.GestionBase.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.EstadoGestion.eges_nombre + ",  <strong>Sub Estado:</strong> " + e.SubEstadoGestion.eges_nombre))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.GestionBase.Descripcion))
                     );
                });

                //console.log(respuesta.Objeto)

                if (respuesta.Objeto.length > 0 && respuesta.Objeto[0].EstadoGestion.ejes_terminal === "CERRADOS") {
                    $(".esconder").hide();
                }


                $("#datos-gestion-sc").bootstrapValidator('resetForm', true);
                //$("#mensaje_guardar").fadeIn();

                $.niftyNoty({
                    type: 'success',
                    container: '#mensahes-mustsc',
                    html: '<strong>OK</strong> Gestion guardada exitosamente.',
                    focus: false,
                    timer: 3000,
                    onHidden: function () {
                        window.location.reload(true);
                    }
                });
            });
        });

        $('#datos-gestion_normalizacion').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],

            fields: {
                ges_causa_basal_normalizacion: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar una causa'
                        }
                    }
                },
                ges_consecuencia_normalizacion: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar una consecuencia'
                        }
                    }
                },
                ges_estado_normalizacion: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un estado'
                        }
                    }
                },
                /*ges_prox_gestion_normalizacion: {
                    validators: {
                        notEmpty: {
                            message: 'La fecha de próxima gestión no puede ser vacía'
                        },
                        date: {
                            format: 'DD-MM-YYYY',
                            message: 'Formato de fecha incorrecto'
                        }
                    }
                },*/
                ges_comentarios_normalizacion: {
                    validators: {
                        notEmpty: {
                            message: 'Debe agregar algún comentario'
                        },
                        stringLength: {
                            message: 'No pueden ser mas de 150 caracteres',
                            max: function (value, validator, $field) {
                                return 150 - (value.match(/\r/g) || []).length;
                            }
                        }
                    }
                },



            }
        }).on('success.form.bv', function (e) {
            // Prevén que se mande el formulario
            e.preventDefault();
            var $form = $(e.target);

            $.SecPostJSON(BASE_URL + "/motor/api/Gestion/guardar-gestion-normalizacion", $form.serialize(), function (respuesta) {

                $("#gestiones_realizadasNorm").html("");
                $.each(respuesta.Objeto, function (i, e) {
                    $("#gestiones_realizadasNorm").append($("<a>").attr("href", '#')
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.Gestor.EjecutivoData.Nombres))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.GestionBase.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.GestionBase.FechaCompromete.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Causa basal:</strong> " + e.CausaBasalGestion.eges_nombre + ",  <strong>Consecuencia:</strong> " + e.ConsecuenciaGestion.eges_nombre + ", <strong>Estado:</strong> " + e.EstadoGestion.eges_nombre))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.GestionBase.Descripcion))
                     );
                });


                if (respuesta.Objeto.length > 0 && respuesta.Objeto[0].EstadoGestion.ejes_terminal === "CERRADOS") {
                    $(".esconder").hide();
                }

                $("#datos-gestion_normalizacion").bootstrapValidator('resetForm', true);

                $.niftyNoty({
                    type: 'success',
                    container: '#mensahes-mustNor',
                    html: '<strong>OK</strong> Gestion guardada exitosamente.',
                    focus: false,
                    timer: 3000,
                    onHidden: function () {
                        window.location.reload(true);
                    }
                });
            });
        });
        $('#datos-gestion-tmc').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            fields: {
                ges_estadoTMC: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un estado'
                        }
                    }
                },
                ges_subestadoTMC: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar un sub estado'
                        }
                    }
                },
                ges_prox_gestionTMC: {
                    validators: {
                        notEmpty: {
                            message: 'La fecha de próxima gestión no puede ser vacía'
                        },
                        date: {
                            format: 'DD-MM-YYYY',
                            message: 'Formato de fecha incorrecto'
                        }
                    }
                },
                ges_comentarios: {
                    validators: {
                        notEmpty: {
                            message: 'Debe agregar algún comentario'
                        },
                        stringLength: {
                            message: 'No pueden ser mas de 150 caracteres',
                            max: function (value, validator, $field) {
                                return 150 - (value.match(/\r/g) || []).length;
                            }
                        }
                    }
                },



            }
        }).on('success.form.bv', function (e) {
            // Prevén que se mande el formulario
            e.preventDefault();
            var $form = $(e.target);

            var objeto_ebnvio = {
                ges_estado: $('#ges_estadoTMC').val(),
                ges_subestado: $('#ges_subestadoTMC').val(),
                ges_prox_gestion: $('#ges_prox_gestionTMC').val(),
                ges_comentarios: $('#ges_comentariosTMC').val(),
                ges_id_asignacion: $('#ges_id_asignacionTMC').val(),
                ges_oficina: getCookie("Oficina"),
                ges_token: getCookie("Token")
            }
            $.SecPostJSON(BASE_URL + "/CPEngine/api/camp/guardar-gestion-cmp", objeto_ebnvio, function (respuesta) {


                $("#gestiones_realizadasTMC").html("");
                $.each(respuesta.Objeto, function (i, e) {
                    $("#gestiones_realizadasTMC").append($("<a>").attr("href", '#')
                         .append($("<h4>").addClass("list-group-item-heading").html("<strong>Gestor:</strong> " + e.RutEjecutivo + "  " + e.NombreEjecutivo))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Fecha Gestión:</strong>" + e.Gestion.FechaAccion.toFechaHora() + ", <strong>Fecha Prox. Gestión:</strong> " + e.Gestion.FechaCompromiso.toFecha()))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Estado:</strong> " + e.EstadoGestion.Nombre + ",  <strong>Sub Estado:</strong> " + e.SubEstadoGestion.Nombre))
                         .append($("<p>").addClass("list-group-item-text").html("<strong>Comentario:</strong> " + e.Gestion.NotaGestion))
                     );
                });

                if (respuesta.Objeto != null && respuesta.Objeto.length > 0 && respuesta.Objeto[0].EstadoGestion.ejes_terminal === "CERRADOS") {
                    $(".esconder").hide();
                }

                $("#datos-gestion-tmc").bootstrapValidator('resetForm', true);
                //$("#mensaje_guardar").fadeIn();

                $.niftyNoty({
                    type: 'success',
                    container: 'floating',
                    html: '<strong>OK</strong> Gestion guardada exitosamente.',
                    focus: false,
                    timer: 3000,
                    onHidden: function () {
                        window.location.reload(true);
                    }
                });
            });
        });

        var rutAf = httpGet("RutBuscar");
        rutAf = rutAf.replace(/\./g, '');
        rutAf = rutAf.substring(0, rutAf.indexOf('-'));
        Cargador.CargaDatosAfiliados(rutAf)
        Cargador.CargaDatosCampaniasAfiliado(rutAf)
        Cargador.CargaDatosCumpleanos(rutAf)
        Cargador.CargaDatosAlertas(rutAf)

        $("#ges_oficina").val(getCookie("Oficina"))
        $("#ges_token").val(getCookie("Token"))
    </script>

}