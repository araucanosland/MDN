@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="es">

<head>
    <title>Motor de Negocios</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700' rel='stylesheet' type='text/css'>
    <link href="~/Assets/css.App/bundle.min.css" rel="stylesheet">


    <link href="~/Assets/plugins/magic-check/css/magic-check.min.css" rel="stylesheet">

    <link href="~/Assets/plugins/bootstrap-validator/bootstrapValidator.min.css" rel="stylesheet">
    <!--Bootstrap Select [ OPTIONAL ]-->
    <link href="~/Assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet">

    <link href="~/Assets/plugins/x-editable/css/bootstrap-editable.css" rel="stylesheet">
    <!--TypeaheadJS [ OPTIONAL ]-->
    <link href="~/Assets/plugins/x-editable/inputs-ext/typeaheadjs/lib/typeahead.js-bootstrap.css" rel="stylesheet">
    <!--Address [ OPTIONAL ]-->
    <link href="~/Assets/plugins/x-editable/inputs-ext/address/address.css" rel="stylesheet">
    <link href="~/Assets/css/demo/nifty-demo-icons.min.css" rel="stylesheet" />
    <link href="~/Assets/css/demo/nifty-demo.min.css" rel="stylesheet">

    <link href="~/Assets/plugins/chosen/chosen.min.css" rel="stylesheet">


    <script src="~/Assets/js.App/bundle.min.js?g=@Guid.NewGuid().ToString()"></script>
</head>
<body>
    <br />
    <br />
    <div class="container">
        <div class="panel">
            <div class="panel-body">
                <p class="text-lg text-semibold panel panel-trans text-center" id="lbMenesajeEncuensta" style="display:none;"><i class="pli-like-2 icon-2x"></i> AFILIADO YA REALIZO ENCUESTA....</p>
                <div class="mar-btm" id="mensajes"></div>
                <div id="DivEncusta">
                    <div class="media-block">
                        <div class="media-left" style="white-space:nowrap">
                            <div class="invoice-logo">
                                <div class="media-left">
                                    <img src="~/Assets/img/logo_arau.png" style="width: 180px" />
                                </div>
                                <br />
                                <div class="media-body">
                                    <h5 class="h3 mar-no">Enfermedades Crónicas y medicamentos </h5>
                                </div>
                            </div>
                        </div>
                        <div class="media-body text-right">
                            <h3 class="h1 text-uppercase text-normal mar-no">ENCUESTA</h3>
                        </div>
                    </div>
                    <hr class="new-section-sm bord-no">
                    <div class="well well-sm" style="border-radius: 7px;">
                        <p class="text-bold text-main mar-no">Señor(a) </p>
                        <p>Caja de Compensación La Araucana, en su constante preocupación por entregar un mejor servicio, está realizando una breve encuesta con el fin de conocer que enfermedades crónicas y medicamente usan sus afiliados para así brindarles más y mejores beneficios.</p>
                    </div>
                    <hr />
                    <div class="row">
                        <p class="text-bold text-main mar-no">
                            1.	¿Ud. tiene alguna enfermedad crónica?
                        </p> <p style="margin-left: 19px;">
                            Tales como presión alta, diabetes, colesterol alto, problemas al corazón, problemas respiratorios, depresión u otra enfermedad emocional o mental, sobrepeso u obesidad, cáncer u otra enfermedad de larga duración.
                        </p>
                    </div>
                    <div class="row" style="margin-left: 10px;">
                        <div class="col-md-9">
                            <div class="radio">
                                <input id="rbEnfermedadSI" class="magic-radio" type="radio" name="rbEnfermedad" value='SI'>
                                <label for="rbEnfermedadSI">SI</label>
                            </div>
                            <div class="radio">
                                <input id="rbEnfermedadNO" class="magic-radio" type="radio" name="rbEnfermedad" value='NO'>
                                <label for="rbEnfermedadNO">NO</label>
                            </div>
                        </div>
                    </div>

                    <div id="divContenedor" style="display:none;">
                        <div class="row">
                            <p class="text-bold text-main mar-no">
                                2.	Nos puede indicar cuál(es) son las enfermedades  crónicas que Ud. posee?
                            </p> <p style="margin-left: 19px;">
                                (Ingrese todas las enfermedades que le indique, con un máximo de 10)
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">

                            <div class="form-group">
                                <div class="panel-body">
                                    <label for="selectEnfermedad" class="sr-only">Seleccione enfermedad</label>
                                    <select id="selectEnfermedad" size="3" data-placeholder="Seleccione enfermedad..." multiple tabindex="4"></select>
                                </div>
                            </div>

                            <div class="row" style="    margin-top: -20px; margin-left: 14px;">
                                <div class="col-md-1 mar-btm">
                                    <div class="checkbox">
                                        <input id="ckOtrosEnfermedad" class="magic-checkbox" type="checkbox">
                                        <label for="ckOtrosEnfermedad">Otro</label>

                                    </div>
                                </div>
                                <div class="col-md-4 mar-btm">
                                    <input type="text" id="txtOtrosEnfermedad" class="form-control" placeholder="" style="width: 200px;" disabled>
                                </div>

                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <p class="text-bold text-main mar-no">
                                3.	Nos puede indicar que medicamento(s) toma para controlar esta(s) enfermedades.
                            </p> <p style="margin-left: 19px;">
                                (Ingrese todos los medicamentos que le indique, con un máximo de 15)
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="form-group">
                                <div class="panel-body">
                                    <label for="selectMedicamentos" class="sr-only">Seleccione medicamentos</label>
                                    <select id="selectMedicamentos" data-placeholder="Seleccione medicamentos..." multiple tabindex="4"></select>

                                </div>
                            </div>
                            <div class="row" style="    margin-top: -20px; margin-left: 14px;">
                                <div class="col-md-1 mar-btm">
                                    <div class="checkbox">
                                        <input id="ckOtrosMedicamentos" class="magic-checkbox" type="checkbox">
                                        <label for="ckOtrosMedicamentos">Otro</label>
                                    </div>
                                </div>
                                <div class="col-md-4 mar-btm">
                                    <input type="text" id="txtOtrosMedicamentos" class="form-control" placeholder="" style="width: 200px;" disabled>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <p class="text-bold text-main mar-no">
                                4.	¿Cómo adquiere estos Medicamentos?
                            </p> <p style="margin-left: 19px;">
                                (Puede seleccionar más de una opción)
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="col-md-9">

                                <div class="checkbox">
                                    <input id="rbConsultorio" class="magic-checkbox" type="checkbox" name="rbAdMedicamentos" value="Consultorio">
                                    <label for="rbConsultorio">Consultorio u Hospital</label>
                                </div>

                                <div class="checkbox">
                                    <input id="rbFarmaciaGES" class="magic-checkbox" type="checkbox" name="rbAdMedicamentos" value="Farmacia por Canasta GES">
                                    <label for="rbFarmaciaGES">En farmacia por Canasta GES</label>
                                </div>

                                <div class="checkbox">
                                    <input id="rbFarmacia" class="magic-checkbox" type="checkbox" name="rbAdMedicamentos" value="Farmacia">
                                    <label for="rbFarmacia">Farmacia</label>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <p class="text-bold text-main mar-no">
                                5.	En qué Farmacia adquiere sus medicamentos preferentemente?
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="col-md-9">
                                <div class="radio">
                                    <input id="rbNoCompra" class="magic-radio" type="radio" name="chkFarmacias" value="Consultorio">
                                    <label for="rbNoCompra">No los compra/Se los dan todos en Consultorio u Hospital </label>
                                </div>
                                <div class="radio">
                                    <input id="rbFAhumada" class="magic-radio" type="radio" name="chkFarmacias" value="Farmacias Ahumada">
                                    <label for="rbFAhumada">Farmacias Ahumada</label>
                                </div>
                                <div class="radio">
                                    <input id="rbCruzVerde" class="magic-radio" type="radio" name="chkFarmacias" value="Cruz Verde">
                                    <label for="rbCruzVerde">Cruz Verde</label>
                                </div>
                                <div class="radio">
                                    <input id="rbSalco" class="magic-radio" type="radio" name="chkFarmacias" value="Salcobrand">
                                    <label for="rbSalco">Salcobrand</label>
                                </div>
                                <div class="radio">
                                    <input id="rbDrSimi" class="magic-radio" type="radio" name="chkFarmacias" value="Dr. Simi">
                                    <label for="rbDrSimi">Dr. Simi	</label>
                                </div>
                                <div class="radio">
                                    <input id="rbPopular" class="magic-radio" type="radio" name="chkFarmacias" value="Farmacia Popular/Comunal">
                                    <label for="rbPopular">Farmacia Popular/Comunal</label>
                                </div>
                                <div class="radio">

                                    <div class="row">
                                        <div class="col-md-3 mar-btm">
                                            <input id="rbOtroCual" class="magic-radio" type="radio" name="chkFarmacias" value="Otra">
                                            <label for="rbOtroCual">Otra, cual? </label>
                                        </div>
                                        <div class="col-md-4 mar-btm">
                                            <input type="text" id="txtOtroCual" class="form-control" placeholder="" style="width: 200px;" disabled>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    @*<div class="row">
                            <p class="text-bold text-main mar-no">
                                6.	Ingrese actividad principal del afiliado
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="col-md-9">
                                <div class="radio">
                                    <input id="rbTrabajador" class="magic-radio" type="radio" name="chkActividad" value="Trabajador">
                                    <label for="rbTrabajador">Trabajador</label>
                                </div>
                                <div class="radio">
                                    <input id="rbPensionado" class="magic-radio" type="radio" name="chkActividad" value="Pensionado">
                                    <label for="rbPensionado">Pensionado</label>
                                </div>
                            </div>
                        </div>*@


                    <div id="divOpcionNo" style="display:none;">

                        <div class="row">
                            <p class="text-bold text-main mar-no" id="titulo_6_2">
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="col-md-9">
                                <div class="radio">
                                    <input id="rbMasculino" class="magic-radio" type="radio" name="chkSexo" value="Masculino">
                                    <label for="rbMasculino">Masculino</label>
                                </div>
                                <div class="radio">
                                    <input id="rbFemenino" class="magic-radio" type="radio" name="chkSexo" value="Femenino">
                                    <label for="rbFemenino">Femenino</label>
                                </div>
                            </div>
                        </div>


                        <div class="row">
                            <p class="text-bold text-main mar-no" id="titulo_7_3">
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="col-md-9">
                                <div class="radio">
                                    <input id="rb18-24" class="magic-radio" type="radio" name="chkEdad" value="18-24">
                                    <label for="rb18-24">18-24 años</label>
                                </div>
                                <div class="radio">
                                    <input id="rb25-34" class="magic-radio" type="radio" name="chkEdad" value="25-34">
                                    <label for="rb25-34">25-34 años</label>
                                </div>
                                <div class="radio">
                                    <input id="rb35-44" class="magic-radio" type="radio" name="chkEdad" value="35-44">
                                    <label for="rb35-44">35-44 años</label>
                                </div>
                                <div class="radio">
                                    <input id="rb45-54" class="magic-radio" type="radio" name="chkEdad" value="45-54">
                                    <label for="rb45-54">45-54 años</label>
                                </div>
                                <div class="radio">
                                    <input id="rb55-64" class="magic-radio" type="radio" name="chkEdad" value="55-64">
                                    <label for="rb55-64">55-64 años</label>
                                </div>
                                <div class="radio">
                                    <input id="rb65-74" class="magic-radio" type="radio" name="chkEdad" value="65-74">
                                    <label for="rb65-74">65-74 años</label>
                                </div>
                                <div class="radio">
                                    <input id="rb75" class="magic-radio" type="radio" name="chkEdad" value="75 o mas">
                                    <label for="rb75">75 o mas años</label>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <p class="text-bold text-main mar-no" id="titulo_8_4">
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="col-md-9">
                                <div class="radio">
                                    <input id="rbFonasa" class="magic-radio" type="radio" name="chkPrevison" value="Fonasa">
                                    <label for="rbFonasa">Fonasa</label>
                                </div>
                                <div class="radio">
                                    <input id="rbIsapre" class="magic-radio" type="radio" name="chkPrevison" value="Isapre">
                                    <label for="rbIsapre">Isapre</label>
                                </div>
                                <div class="radio">
                                    <input id="rbCapredena" class="magic-radio" type="radio" name="chkPrevison" value="Capredena">
                                    <label for="rbCapredena">Capredena</label>
                                </div>
                                <div class="radio">
                                    <input id="rbDipreca" class="magic-radio" type="radio" name="chkPrevison" value="Dipreca">
                                    <label for="rbDipreca">Dipreca</label>
                                </div>

                            </div>
                        </div>
                        <div class="row">
                            <p class="text-bold text-main mar-no" id="titulo_9_5">
                            </p>
                        </div>
                        <div class="row" style="margin-left: 10px;">
                            <div class="panel-body">
                                <select id="region-encuesta" class="form-control" data-placeholder="Seleccione..."></select>
                            </div>
                        </div>
                        <hr class="new-section-sm bord-no">
                        <div class="well well-sm" style="border-radius: 7px;">
                            <p class="text-bold text-main mar-no" id="NomAfiliado"> </p>
                            <p>Agradecemos su disposición a responder. Toda la información entregada es confidencial y servirá para brindarle un mejor servicio.</p>
                        </div>
                    </div>
                    <hr />
                    <button class="btn btn-success btn-rounded" id="btFinalizar">Finalizar Encuesta</button>
                </div>
            </div>
        </div>
    </div>
    <script src="~/Assets/js.App/bundle.min.js?g=@Guid.NewGuid().ToString()"></script>
    <script src="~/Assets/plugins/fooTable/dist/footable.all.min.js"></script>
    <script src="~/Assets/plugins/bootstrap-validator/bootstrapValidator.min.js"></script>
    <!--Bootstrap Select [ OPTIONAL ]-->
    <script src="~/Assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
    <!--Bootbox Modals [ OPTIONAL ]-->
    <script src="~/Assets/plugins/bootbox/bootbox.min.js"></script>
    <!--Masked Input [ OPTIONAL ]-->
    <script src="~/Assets/plugins/masked-input/jquery.maskedinput.min.js"></script>
    <script src="~/Assets/js/jquery.rut.chileno.min.js"></script>
    <script src="~/Assets/plugins/fooTable/dist/footable.all.min.js"></script>

    <!--MomentJS [ OPTIONAL ]-->
    <script src="~/Assets/plugins/momentjs/moment.min.js"></script>

    <!--X-editable [ OPTIONAL ]-->
    <script src="~/Assets/plugins/x-editable/js/bootstrap-editable.min.js"></script>
    <script src="~/Assets/plugins/x-editable/inputs-ext/address/address.js"></script>

    <script src="~/Assets/plugins/chosen/chosen.jquery.min.js"></script>

    <script>

        /*ENCUESTA*/

        $("#NomAfiliado").html("Señor(a) " + httpGet("NombreAfi"))

        $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/lista-estado-encuesta", { RutAfiliado: httpGet("RutBuscar") }, function (datos) {
            if (datos.length != 0) {
                if (datos[0].Flag_Encuesta == 1) {
                    $('#DivEncusta').css('display', 'none')
                    $('#lbMenesajeEncuensta').css('display', 'block')
                    $('#AlertaEncuesta').css('display', 'none')
                }
            }
            else {
                $('#DivEncusta').css('display', 'block')
                $('#lbMenesajeEncuensta').css('display', 'none')
                $('#AlertaEncuesta').css('display', 'block')
            }

            if ($('#NombreAfiliado').html() == "Afiliado Sin Información") {
                $('#DivEncusta').css('display', 'none')
                $('#lbMenesajeEncuensta').css('display', 'block')
                $('#lbMenesajeEncuensta').html("Rut ingresado no corresponde a Afiliado Titular Vigente")
                $('#AlertaEncuesta').css('display', 'none')
            }
        });

        $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/lista-enfermedades-encuesta", function (menus) {
            $("#selectEnfermedad").html("");
            $.each(menus, function (i, e) {
                $("#selectEnfermedad").append($("<option>").attr("value", e.Patologia).html(e.Patologia))
            });
            $('#selectEnfermedad').chosen({ width: '100%' });
        });


        $.SecGetJSON(BASE_URL + "/motor/api/Afiliados/lista-medicamentos-encuesta", function (menus) {
            $("#selectMedicamentos").html("");
            $.each(menus, function (i, e) {
                $("#selectMedicamentos").append($("<option>").attr("value", e.Medicamento).html(e.Medicamento))
            });
            $('#selectMedicamentos').chosen({ width: '100%' });
        });



        $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-region-empresa", function (menus) {
            $("#region-encuesta").html("");
            $("#region-encuesta").append($("<option>").attr("value", "").html(""));
            $.each(menus, function (i, e) {
                $("#region-encuesta").append($("<option>").attr("value", e.Region_nombre).html(e.Region_nombre))
            });
            $('#region-encuesta').chosen({ width: '100%' });
        });


        $("input:radio[name=rbEnfermedad]").click(function () {
            switch (this.value) {
                case "SI":
                    $('#titulo_6_2').html('6.	Ingrese género del afiliado encuestado');
                    $('#titulo_7_3').html('7.	¿Cuál es su Edad?');
                    $('#titulo_8_4').html('8.	¿Cuál es su Régimen de Salud?');
                    $('#titulo_9_5').html('9.	Ingrese Región de residencia del afiliado');
                    $('#divContenedor').css('display', 'block');
                    $('#divOpcionNo').css('display', 'block');
                    datosEncuenta.Tiene_Enfermedad = this.value
                    break;
                case "NO":
                    $('#titulo_6_2').html('2.	Ingrese género del afiliado encuestado');
                    $('#titulo_7_3').html('3.	¿Cuál es su Edad?');
                    $('#titulo_8_4').html('4.	¿Cuál es su Régimen de Salud?');
                    $('#titulo_9_5').html('5.	Ingrese Región de residencia del afiliado');
                    $('#divContenedor').css('display', 'none');
                    $('#divOpcionNo').css('display', 'block');

                    datosEncuenta.Tiene_Enfermedad = this.value
                    break;
            }
        });

        $("input:radio[name=chkActividad]").click(function () {
            switch (this.value) {
                case "Trabajador":
                    datosEncuenta.Actividad = this.value
                    break;
                case "Pensionado":
                    datosEncuenta.Actividad = this.value
                    break;
            }
        });

        $("input:radio[name=chkPrevison]").click(function () {
            switch (this.value) {
                case "Fonasa":
                    datosEncuenta.Prevision = this.value
                    break;
                case "Isapre":
                    datosEncuenta.Prevision = this.value
                    break;
                case "Capredena":
                    datosEncuenta.Prevision = this.value
                    break;
                case "Dipreca":
                    datosEncuenta.Prevision = this.value
                    break;
            }
        });

        $("input:radio[name=chkSexo]").click(function () {
            switch (this.value) {
                case "Masculino":
                    datosEncuenta.Sexo = this.value
                    break;
                case "Femenino":
                    datosEncuenta.Sexo = this.value
                    break;
            }
        });

        $("input:radio[name=chkEdad]").click(function () {
            switch (this.value) {
                case "18-24":
                    datosEncuenta.Edad = this.value
                    break;
                case "25-34":
                    datosEncuenta.Edad = this.value
                    break;
                case "35-44":
                    datosEncuenta.Edad = this.value
                    break;
                case "45-54":
                    datosEncuenta.Edad = this.value
                    break;
                case "55-64":
                    datosEncuenta.Edad = this.value
                    break;
                case "65-74":
                    datosEncuenta.Edad = this.value
                    break;
                case "75 o mas":
                    datosEncuenta.Edad = this.value
                    break;
            }
        });

        $('#region-encuesta').change(function (e) {
            e.preventDefault();
            if ($(this).val() != '') {
                datosEncuenta.Region = this.value
            }
        });

        $('#ckOtrosEnfermedad').on('click', function () {
            if ($(this).is(':checked')) {
                $('#txtOtrosEnfermedad').removeAttr("disabled");
            } else {
                $('#txtOtrosEnfermedad').attr("disabled", "disabled");
            }
        });
        $('#ckOtrosMedicamentos').on('click', function () {
            if ($(this).is(':checked')) {
                $('#txtOtrosMedicamentos').removeAttr("disabled");
            } else {
                $('#txtOtrosMedicamentos').attr("disabled", "disabled");
            }
        });

        $('#ckOtrosMedicamentos').on('click', function () {
            if ($(this).is(':checked')) {
                $('#txtOtrosMedicamentos').removeAttr("disabled");
            } else {
                $('#txtOtrosMedicamentos').attr("disabled", "disabled");
            }
        });
        $("input:checkbox[name=rbAdMedicamentos]").click(function () {
            switch (this.value) {
                case "Consultorio":
                    datosEncuenta.Adquiere_Consultorio = this.value
                    break;
                case "Farmacia por Canasta GES":
                    datosEncuenta.Adquiere_CanastaGes = this.value
                    break;
                case "Farmacia":
                    datosEncuenta.Adquiere_Farmacia = this.value
                    break;
            }
        });

        $("input:radio[name=chkFarmacias]").click(function () {
            switch (this.value) {
                case "Consultorio":
                    $('#txtOtroCual').attr("disabled", "disabled");
                    $('#txtOtroCual').val("")
                    datosEncuenta.NombreFarmacia = this.value
                    break;
                case "Farmacias Ahumada":
                    $('#txtOtroCual').attr("disabled", "disabled");
                    $('#txtOtroCual').val("")
                    datosEncuenta.NombreFarmacia = this.value
                    break;
                case "Cruz Verde":
                    $('#txtOtroCual').attr("disabled", "disabled");
                    $('#txtOtroCual').val("")
                    datosEncuenta.NombreFarmacia = this.value
                    break;
                case "Salcobrand":
                    $('#txtOtroCual').attr("disabled", "disabled");
                    $('#txtOtroCual').val("")
                    datosEncuenta.NombreFarmacia = this.value
                    break;
                case "Dr. Simi":
                    $('#txtOtroCual').attr("disabled", "disabled");
                    $('#txtOtroCual').val("")
                    datosEncuenta.NombreFarmacia = this.value
                    break;
                case "Farmacia Popular/Comunal":
                    $('#txtOtroCual').attr("disabled", "disabled");
                    $('#txtOtroCual').val("")
                    datosEncuenta.NombreFarmacia = this.value
                    break;
                case "Otra":
                    $('#txtOtroCual').removeAttr("disabled");
                    break;
            }
        });


        var datosEncuenta = {}
        $("#btFinalizar").on("click", function () {
            $('#btFinalizar').attr("disabled", "disabled");
            var Enfermedad = [];
            var medicamento = [];
            var errores = [];
            var erroresNO = [];

            $('#selectEnfermedad :selected').each(function () {
                Enfermedad.push($(this).val())
            });
            $.each(Enfermedad, function (i, e) {
                datosEncuenta['Enfermedad_' + (i + 1)] = Enfermedad[i];
            });

            if (Enfermedad.length < 11) {
                var i = Enfermedad.length;
                while (i < 11) {
                    datosEncuenta['Enfermedad_' + (i + 1)] = "NULL"
                    i++;
                }
            }
            if ($('#txtOtrosEnfermedad').val() != "" && Enfermedad.length < 11) {
                Enfermedad.push(datosEncuenta['Enfermedad_11'] = $('#txtOtrosEnfermedad').val());
            }



            $('#selectMedicamentos :selected').each(function () {
                medicamento.push($(this).val())
            });
            $.each(medicamento, function (i, e) {
                datosEncuenta['Medicamentos_' + (i + 1)] = medicamento[i];
            });

            if (medicamento.length < 17) {
                var i = medicamento.length;
                while (i < 16) {
                    datosEncuenta['Medicamentos_' + (i + 1)] = "NULL"
                    i++;
                }
            }
            if ($('#txtOtrosMedicamentos').val() != "" && medicamento.length < 16) {
                medicamento.push(datosEncuenta['Medicamentos_16'] = $('#txtOtrosMedicamentos').val());
            }


            if ($('#txtOtroCual').val() != "") {
                datosEncuenta.NombreFarmacia = $('#txtOtroCual').val()
            }


            var segmento = httpGet("Segmento");
            if (segmento == "PRIVADOS") {
                datosEncuenta.Actividad = "Privado"
            }
            else if (segmento == "PENSIONADOS") {
                datosEncuenta.Actividad = "Pensionado"
            }
            else if (segmento == "PUBLICOS") {
                datosEncuenta.Actividad = "Público"
            }


            datosEncuenta.Rut_Afiliado = httpGet("RutBuscar");
            //datosEncuenta.Actividad = httpGet("Segmento");
            datosEncuenta.Nombre_Afiliado = httpGet("NombreAfi");
            datosEncuenta.Rut_Ejecutivo = httpGet("ejecutivo");
            datosEncuenta.Sucursal = 555;
            datosEncuenta.Region = $("#region-encuesta").val();
            datosEncuenta.Flag_Encuesta = 1;

            function addValidation(slected, message) {
                if (slected.length == 0) {
                    errores.push(message);
                }
            }
            function addValidationNO(slected, message) {
                if (slected.length == 0) {
                    erroresNO.push(message);
                }
            }
            function addValidationEnferMed(slected, message) {
                if (slected.length == 0) {
                    erroresNO.push(message);
                }
            }


            /*Validacion de:  Farmacias*/
            addValidation($("input[name=chkFarmacias]:checked"), '*Debes seleccionar una Farmacia..')
            addValidation($("input[name=chkSexo]:checked"), '*Debes seleccionar el Genero..')
            addValidation($("input[name=chkEdad]:checked"), '*Debes seleccionar un rago de edad..')
            addValidation($("input[name=chkPrevison]:checked"), '*Debes seleccionar una prevision..')
            addValidation($("input[name=rbAdMedicamentos]:checked"), '*Debes seleccionar adquiere medicamento..')
            addValidation($("#region-encuesta").val(), '*Debes seleccionar una region..')
            // addValidation($("#selectEnfermedad").val(), '* Debe seleccionar una enfermedad u otra..')
            //addValidation($("#selectMedicamentos").val(), '* Debe seleccionar un medicamento u otro..')

            addValidationNO($("input[name=chkSexo]:checked"), '*Debes seleccionar el Genero..')
            addValidationNO($("input[name=chkEdad]:checked"), '*Debes seleccionar un rago de edad..')
            addValidationNO($("input[name=chkPrevison]:checked"), '*Debes seleccionar una prevision..')
            addValidationNO($("#region-encuesta").val(), '*Debes seleccionar una region..')


            //$("#selectEnfermedad").val().length  $('#txtOtrosEnfermedad').val().length

            if ($("#selectEnfermedad").val().length == 0 && $('#txtOtrosEnfermedad').val().length == 0) {
                addValidation($("#selectEnfermedad").val(), '* Debe seleccionar una enfermedad u otra..')
            }

            if ($("#selectMedicamentos").val().length == 0 && $('#txtOtrosMedicamentos').val().length == 0) {
                addValidation($("#selectMedicamentos").val(), '* Debe seleccionar un medicamento u otro..')
            }



            //Verificador final
            if (errores.length > 0 && datosEncuenta.Tiene_Enfermedad == "SI") {
                $('#btFinalizar').removeAttr("disabled");
                $.niftyNoty({
                    type: 'danger',
                    container: '#mensajes',
                    title: 'Error',
                    message: errores.join('\n'),
                    closeBtn: false,
                    timer: 8000,
                });
                return false;
            }
            else if (erroresNO.length > 0 && datosEncuenta.Tiene_Enfermedad == "NO") {
                $('#btFinalizar').removeAttr("disabled");
                $.niftyNoty({
                    type: 'danger',
                    container: '#mensajes',
                    title: 'Error',
                    message: erroresNO.join('\n'),
                    closeBtn: false,
                    timer: 8000,
                });
                return false;
            }

            if ($("input[name=rbEnfermedad]:checked").length == 0) {
                $('#btFinalizar').removeAttr("disabled");
                $.niftyNoty({
                    type: 'danger',
                    container: '#mensajes',
                    title: 'Error',
                    message: "DEBE INGRESAR UNA OPCION",
                    closeBtn: false,
                    timer: 8000,
                });
                return false;
            }




            $.SecPostJSON(BASE_URL + "/motor/api/Afiliados/guarda-encueasta-enfermedades", datosEncuenta, function (respuesta) {
                $.niftyNoty({
                    type: 'success',
                    container: '#mensajes',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Encuesta Grabada Exitosamente.',
                    timer: 5000
                });

                $('#DivEncusta').css('display', 'none')
                $('#lbMenesajeEncuensta').css('display', 'block')
                $('#AlertaEncuesta').css('display', 'none')
                $('input[type="radio"]').prop('checked', false);
                $('input[type="checkbox"]').prop('checked', false);
                $('#txtOtrosEnfermedad').val("");
                $('#txtOtrosMedicamentos').val("");
                $('#txtOtroCual').val("");

            });

        });

        $('#selectEnfermedad').change(function (event) {
            $('#btFinalizar').removeAttr("disabled");
            if ($(this).val().length > 10) {
                $.niftyNoty({
                    type: 'danger',
                    container: '#mensajes',
                    title: 'Error',
                    message: 'Solo puede seleccionar 10 enfermedades.',
                    closeBtn: false,
                    timer: 8000,
                });
            }
        });

        $('#selectMedicamentos').change(function (event) {
            $('#btFinalizar').removeAttr("disabled");
            if ($(this).val().length > 15) {
                $.niftyNoty({
                    type: 'danger',
                    container: '#mensajes',
                    title: 'Error',
                    message: 'Solo puede seleccionar 15 medicamentos.',
                    closeBtn: false,
                    timer: 8000,
                });
            }
        });



    </script>



</body>
</html>