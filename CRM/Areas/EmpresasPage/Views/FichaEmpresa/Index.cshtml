
@{
    Layout = "~/Areas/EmpresasPage/Views/Shared/_Layout.cshtml";
}
<link href="~/Assets/plugins/dropzone/dropzone.min.css" rel="stylesheet">
<link href="~/Assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet">
<link href="~/Assets/plugins/chosen/chosen.min.css" rel="stylesheet">
<link href="~/Assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.css" rel="stylesheet">
<link href="~/Assets/plugins/switchery/switchery.min.css" rel="stylesheet">
<link href="~/Assets/plugins/magic-check/css/magic-check.min.css" rel="stylesheet">

<link href="~/Assets/plugins/fullcalendar/fullcalendar.min.css" rel="stylesheet">
<link href="~/Assets/plugins/fullcalendar/nifty-skin/fullcalendar-nifty.min.css" rel="stylesheet">

<link href="~/Assets/plugins/bootstrap-timepicker/bootstrap-timepicker.min.css" rel="stylesheet">


<h1 id="tituloEmp">Ficha de Empresa</h1>
<div id="page-content">
    <div class="row">
        <div class="col-lg-12">
            <div class="panel" style="border-radius: 6px;">
                <div class="panel-body">
                    <h2 class="panel-title">
                        <span class="pull-left badge badge-danger" style="border-radius: 4px; display: none;" id="msjNoMoles">No Molestar</span><span class="pull-left badge badge-success" style="border-radius: 4px; margin-left: 5px; display:none" id="cumpleanos">Afiliado esta de Cumpleaños</span><span class="pull-left badge badge-warning" style="border-radius: 4px; margin-left: 5px; display:none" id="afinuevo">Afi Nuevo</span><span class="pull-left badge badge-success" style="border-radius: 4px; margin-left: 5px;" id="afiVigente"></span><span class="pull-left badge badge-danger" style="border-radius: 4px; margin-left: 5px; display:none" id="afiFallecido "></span><span class="pull-left badge badge-danger" style="border-radius: 4px; margin-left: 5px; display:none" id="afiContac">Actualizar Contactos</span>
                    </h2>
                    <hr />
                    <div class="row">
                        <div class="col-sm-3">
                            <div class="form-group">
                                <div class="panel pos-rel" style="border-radius: 5px;">
                                    <div class="pad-all text-center">
                                        <img alt="Profile Picture" class="img-lg img-circle mar-ver" src="~/Assets/img/imgEmpresas.png" />
                                        <p class="text-lg text-semibold mar-no text-main" id="NombreEmpresaPer" style="font-size: 12px;"></p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-9">
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-sm-2">
                                        <div class="form-group">
                                            <h5><label class="control-label">Rut</label></h5>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="RutEmp" id="RutEmp" readonly="readonly" style="font-weight:bold" />
                                        </div>
                                    </div>

                                    <div class="col-sm-3" style="margin-left: 30px;">
                                        <div class="form-group">
                                            <h5><label class="control-label">Antiguedad años</label></h5>
                                        </div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="AntiguedadA" id="AntiguedadA" readonly="readonly" style="font-weight:bold" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-2">
                                        <div class="form-group">
                                            <h5><label class="control-label">Segmento</label></h5>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="SegmentoEmp" id="SegmentoEmp" readonly="readonly" style="font-weight: bold;" />
                                            <div class="label label-table label-success" style="display:none">Cumpleaños</div>
                                        </div>
                                    </div>


                                    <div class="col-sm-3" style="margin-left: 30px;">
                                        <div class="form-group">
                                            <h5><label class="control-label">N° Trabajadores</label></h5>
                                        </div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="nTrabajadores" id="nTrabajadores" readonly="readonly" style="font-weight:bold" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-2">
                                        <div class="form-group">
                                            <h5><label class="control-label">Holding</label></h5>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="HoldingEmp" id="HoldingEmp" readonly="readonly" style="font-weight: bold;" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="panel" style="border-radius: 6px;">

                <!--Panel heading-->
                <div class="panel-heading">
                    <div class="panel-control" style="float:left;">
                        <ul class="nav nav-tabs">
                            <li id="liPlanif" class="active">
                                <a data-toggle="tab" href="#demo-lft-tab-4" aria-expanded="true" id="tab_Planificacion" style="font-weight: bold;">Planificación <span id="ncitas" class="pull-right badge badge-danger" style="margin-top: 12px;">0</span></a>
                            </li>
                            <li class="">
                                <a data-toggle="tab" href="#demo-lft-tab-3" aria-expanded="false" id="tab_anexos" style="font-weight: bold;">Anexos</a>
                            </li>
                            <li id="liPlanif" class="" style="display:block;">
                                <a data-toggle="tab" href="#demo-lft-tab-1" aria-expanded="true" id="tab_comercial" style="font-weight: bold;">Visitas</a>
                            </li>
                            <li class="">
                                <a data-toggle="tab" href="#demo-lft-tab-2" aria-expanded="false" id="tab_oportunidad" style="font-weight: bold;">Oportunidades<span class="badge badge-success" id="cantAlertas"></span></a>
                            </li>

                        </ul>
                    </div>
                    <h3 class="panel-title" style="color:white">.</h3>
                </div>
                <div class="panel-body">
                    <div class="tab-content">
                        <div id="demo-lft-tab-3" class="tab-pane fade">
                            <div class="panel-body">
                                <div id="radioValidador" style="display:none;">
                                    <div class="radio">
                                        <input id="radioAnexo" class="magic-radio" type="radio" name="inline-form-radio">
                                        <label for="radioAnexo">¿Desea crear un Anexo?</label>
                                        <br />
                                        <br />
                                        <input id="radioEmpresa" class="magic-radio" type="radio" name="inline-form-radio">
                                        <label for="radioEmpresa">¿Desea Asignar una Empresa?</label>
                                    </div>
                                    <hr />
                                </div>
                                <div class="panel panel-bordered-primary" style="border-color: #e6e6e6; display: none; border-radius: 5px;" id="tipoAsignacionEmpresa">

                                    <div class="panel-body">
                                        <div class="row">

                                            <div class="panel-heading">
                                                <h3 class="panel-title" style="font-size: 14px;">Asignar Empresas a ejecutivos</h3>
                                            </div>
                                            <div class="panel-body">
                                                <label for="demo-cs-multiselectEjeEmpresa" class="sr-only">Asignar Empresas</label>
                                                <select id="demo-cs-multiselectEjeEmpresa" data-placeholder="Seleccione a los ejecutivos.." multiple tabindex="4"></select>
                                                <button class="btn btn-primary" id="btAsignaEmpresa" type="submit">Asignar</button>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div id="tipoAsignacionAnexo" style="display: none">
                                    @*Anexo*@
                                    <a data-target="#demo-lg-modal-newAnexo" data-toggle="modal" class="btn btn-sm btn-primary btn-icon btn-rounded">Crear Nuevo Anexo<i class="demo-psi-building icon-lg" style="margin-left: 10px;"></i></a>
                                    <hr />
                                    <table style="font-size: 12px;" id="tblAnexos" class="table table-hover table-vcenter">
                                        <thead>
                                            <tr>
                                                <th>Rut Empresa</th>
                                                <th>Nombre Anexo</th>
                                                <th>N° Trabajadores</th>
                                                <th>Editar</th>
                                                <th>Asignar</th>
                                            </tr>
                                        </thead>
                                        <tbody class="buscar" id="tbdyAnexo"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!--VISITAS-->
                        <div id="demo-lft-tab-1" class="tab-pane fade">
                            <br />
                            <a data-target="#demo-lg-modal-entrevista" data-toggle="modal" class="btn btn-sm btn-primary btn-icon btn-rounded">Nueva Gestion<i class="demo-psi-receipt-4 icon-lg" style="margin-left: 10px;"></i></a>
                            <br />
                            <br />

                            <div id="radioTablagestiones">
                                <div class="radio">
                                    <input id="radioMantenedor" class="magic-radio " type="radio" name="groupCkeckAlerta_visitas" value='Mantenedor' checked>
                                    <label for="radioMantenedor">Gestion de Mantención realizadas</label>

                                    <input id="radioEntrevistas" class="magic-radio" type="radio" name="groupCkeckAlerta_visitas" value='Visita'>
                                    <label for="radioEntrevistas">Entrevistas Realizadas</label>
                                </div>
                                <hr />
                            </div>
                            <div class="panel-group accordion" id="accordion">
                                <div class="panel">
                                    <div class="panel-collapse collapse colap1 in" id="collapseOne">
                                        <div class="panel-body">
                                            <h3 class="text-bold text-main mar-no" style="color: #b3b3b3">Gestion de Mantención Realizadas</h3>
                                            <br />

                                            <table style="font-size: 12px;" id="tblGestMan" class="table table-bordered table-hover toggle-circle table-striped">
                                                <thead>
                                                    <tr>
                                                        <th>Fecha Ingreso</th>
                                                        <th>Tipo</th>
                                                        <th>Comentarios</th>
                                                        <th>Nombre Ejecutivo Ingreso</th>
                                                        <th>Detalle</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="buscar" id="tbdyGestMan"></tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                                <div class="panel" style="margin-top: 0px;">
                                    <div class="panel-collapse collapse colap2" id="collapseTwo">
                                        <div class="panel-body">
                                            <h3 class="text-bold text-main mar-no" style="color: #b3b3b3">Entrevistas Realizadas</h3>
                                            <br />
                                            <table style="font-size: 12px;" id="tblEntrevista" class="table table-bordered table-hover toggle-circle table-striped">
                                                <thead>
                                                    <tr>
                                                        <th>Fecha Entrevista</th>
                                                        <th>Tipo</th>
                                                        <th>Nombre</th>
                                                        <th>Cargo</th>
                                                        <th>Estamento</th>
                                                        <th>Detalle</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="buscar" id="tbdyentrevista"></tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="demo-lft-tab-2" class="tab-pane fade">
                            <div class="panel-body">
                                <a data-target="#demo-lg-modal-new" data-toggle="modal" class="btn btn-sm btn-primary btn-icon btn-rounded">Nueva Gestion<i class="demo-psi-building icon-lg" style="margin-left: 10px;"></i></a>
                                <hr />
                                <table style="font-size: 12px;" id="tblAsigEmp" class="table table-hover table-vcenter">
                                    <thead>
                                        <tr>
                                            <th data-field="state" data-checkbox="true"></th>
                                            <th hidden></th>
                                            <th>Rut</th>
                                            <th>Nombres</th>
                                            <th>Oferta</th>
                                            <th>Tipo Oferta</th>
                                            <th>Estado</th>
                                        </tr>
                                    </thead>
                                    <tbody class="buscar" id="tbOportunidad"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="demo-lft-tab-4" class="tab-pane fade active in">
                            <div id="page-content">
                                <div class="row">
                                    <div class="col-md-4 col-lg-3">
                                        <div class="panel" style="border-radius: 9px; border: 1px solid #d8dce0;">
                                            <div class="panel-heading">
                                                <h3 class="panel-title">Tipos de Gestion</h3>
                                            </div>
                                            <div class="panel-body">

                                                <div id="demo-external-events">
                                                    <div class="fc-event fc-list">Terreno</div>
                                                    <div class="fc-event fc-list" data-class="warning">Telefono</div>
                                                    <div class="fc-event fc-list" data-class="success">Mail</div>
                                                    <hr>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8 col-lg-9">
                                        <div class="panel" style="border-radius: 9px; border: 1px solid #d8dce0;">
                                            <div class="panel-heading">
                                                <h3 class="panel-title">Calendario</h3>
                                            </div>
                                            <div class="panel-body">
                                                <div id='demo-calendar'></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@*MODAL DE VISITAS*@
<div id="demo-lg-modal-entrevista" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 13px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title"><i class="demo-psi-receipt-4 icon-lg" style="margin-left: 10px;"></i>    Ingreso Visita</h4>

            </div>
            <div class="panel-body">
                <div id="radioVisitas">
                    <div class="radio">
                        <input id="radioVisita" class="magic-radio" type="radio" name="inline-form-radio">
                        <label for="radioVisita">¿Desea hacer una gestion de Mantención?</label>
                        <br />
                        <br />
                        <input id="radioEntravista" class="magic-radio" type="radio" name="inline-form-radio">
                        <label for="radioEntravista">¿Desea gestionar una entrevista?</label>
                    </div>
                    <hr />
                </div>


                <div class="form-horizontal" style="display: none;" id="divEntrevista">
                    <h4>Datos de Entrevista</h4>
                    <form id="form-registro-entrevista" action="#" method="post">
                        <div class="panel panel-bordered-dark" style="border-radius: 8px; border: 1px solid #e5e5e5;">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Fecha</label>
                                        <div id="demo-dp-component">
                                            <div class="input-group date">
                                                <input class="form-control input-group date" type="text" id="FechaGestges" name="FechaGestges">
                                                <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Nombre Contacto</label>
                                        <input type="text" id="nombContacto" name="nombContacto" class="form-control" placeholder="Nombre">
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Estamento</label>
                                        <select class="form-control" id="slEstamento" tabindex="2" name="slEstamento" required>
                                            <option value="">Seleccione</option>
                                            <option value="Empresa">Empresa</option>
                                            <option value="Sindicato">Sindicato</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Cargo</label>
                                        <input type="text" id="txtCargo" name="txtCargo" class="form-control selectpicker" placeholder="Cargo">
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Telefono de Contacto</label>
                                        <input type="text" id="tefContacto" name="tefContacto" class="form-control" placeholder="Telefono">
                                    </div>

                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Correo de Contacto</label>
                                        <input type="text" id="correoContacto" name="correoContacto" class="form-control" placeholder="correo">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-8 mar-btm">
                                        <textarea placeholder="Comentarios" rows="4" class="form-control" id="txtComentariosCab" name="txtComentariosCab" style="height: 62px;"></textarea>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <button class="btn btn-sm btn-primary btn-icon btn-rounded" id="btGuardaCabecera" style="margin-top: 31px;">Guardar Datos de Entrevista<i class="demo-psi-add icon-lg" style="margin-left: 10px;"></i></button>
                                    </div>
                                </div>
                                <div id="msjEntrevistaCab"></div>
                            </div>

                        </div>
                    </form>


                    <form id="form_entrevista_detalle" action="#" method="post" style="display:none">
                        <h4>Detalle Entrevista</h4>
                        <div class="panel panel-bordered-dark" style="border-radius: 8px; border: 1px solid #e5e5e5;">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Tema</label>
                                        <select id="slTema" class="form-control" name="slTema"></select>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Sub-Tema</label>
                                        <select id="slSubTema" class="form-control" name="slSubTema"></select>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Semaforo Relación</label>
                                        <select id="slSemaforo" name="slSemaforo" class="form-control" tabindex="-98">
                                            <option value="">Seleccione</option>
                                            <option data-content="<span class=&quot;badge badge-success&quot; style='width: 100%; background-color: #8bc34a;'>Verde</span>" value="Verde">Verde</option>
                                            <option data-content="<span class=&quot;badge badge-warning&quot; style='width: 100%; background-color: #ffb300;'>Amarillo</span>" value="Amarillo">Amarillo</option>
                                            <option data-content="<span class=&quot;badge badge-danger&quot; style='width: 100%; background-color: #f44336;'>Rojo</span>" value="Rojo">Rojo</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Compromiso</label>
                                        <div class="radio">
                                            <input id="ckCompromisoSI" class="magic-radio" type="radio" name="groupCkeckCompromiso" value='SI'>
                                            <label for="ckCompromisoSI">SI</label>
                                            <input id="ckCompromisoNO" class="magic-radio" type="radio" name="groupCkeckCompromiso" value='NO' checked>
                                            <label for="ckCompromisoNO">NO</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mar-btm" style="display: none" id="divFechaResul">
                                        <label class="control-label">Fecha de Resolución</label>
                                        <div id="demo-dp-component">
                                            <div class="input-group date">
                                                <input class="form-control" type="text" id="FechaResolucion" name="FechaResolucion">
                                                <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Alerta</label>
                                        <div class="radio">
                                            <input id="ckAlertaSI" class="magic-radio" type="radio" name="groupCkeckAlerta" value='SI'>
                                            <label for="ckAlertaSI">SI</label>
                                            <input id="ckAlertaNO" class="magic-radio" type="radio" name="groupCkeckAlerta" value='NO' checked>
                                            <label for="ckAlertaNO">NO</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 mar-btm">
                                        <textarea placeholder="Comentarios" rows="4" class="form-control" id="comentarioDtEn" name="comentarioDtEn"></textarea>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-primary btn-icon btn-rounded" id="btGuardaDetalleEntrevista" disabled>Guardar y Agregar<i class="demo-psi-add icon-lg" style="margin-left: 10px;"></i></button>

                                <div id="msjEntrevistaDet"></div>
                            </div>

                        </div>
                    </form>
                </div>
                <div class="form-horizontal" style="display: none;" id="divVisita">
                    <form id="form_gestion_mantencion" action="#" method="post">
                        <div class="panel panel-bordered-dark" style="border-radius: 8px; border: 1px solid #e5e5e5;">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Fecha</label>
                                        <div id="demo-dp-component">
                                            <div class="input-group date">
                                                <input class="form-control input-group date" type="text" id="FechaCabeceraGest" name="FechaCabeceraGest">
                                                <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Tipo</label>
                                        <div class="btn-group bootstrap-select form-control">
                                            <select id="slTipoGestion" name="slTipoGestion" class="form-control selectpicker" tabindex="-98">
                                                <option value="">Seleccione</option>
                                                <option value="Terreno">Terreno</option>
                                                <option value="Telefono">Telefono</option>
                                                <option value="Mail">Mail</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <br />
                                        <button class="btn btn-sm btn-primary btn-icon btn-rounded" id="btGuardaGestionMan" style="margin-top: 13px;">Guardar datos de gestion mantención<i class="demo-psi-add icon-lg" style="margin-left: 10px;"></i></button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 mar-btm">
                                        <label class="control-label">Comentarios</label>
                                        <textarea placeholder="Comentarios" rows="4" class="form-control" id="comentarioCabeceraGestion" name="comentarioCabeceraGestion" style="display: block"></textarea>
                                    </div>
                                </div>

                                <div id="msjMantGestCab"></div>
                            </div>
                        </div>
                    </form>
                    <form id="form_gestion_mantencion_detalle" action="#" method="post" style="display:none">
                        <div class="panel panel-bordered-dark" style="border-radius: 8px; border: 1px solid #e5e5e5;">
                            <div class="panel-body">

                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Tema</label>
                                        <select id="slTemaGestion" class="form-control" name="slTema"></select>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Sub-Tema</label>
                                        <select id="slSubTemavisita" class="form-control" name="slSubTemavisita"></select>
                                    </div>

                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Alerta</label>
                                        <div class="radio">
                                            <input id="ckAlertaSIGestion" class="magic-radio" type="radio" name="groupCkeckAlertaGestion" value='SI'>
                                            <label for="ckAlertaSIGestion">SI</label>
                                            <input id="ckAlertaNOGestion" class="magic-radio" type="radio" name="groupCkeckAlertaGestion" value='NO' checked>
                                            <label for="ckAlertaNOGestion">NO</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 mar-btm">
                                        <label class="control-label">Afiliado Gestionado</label>
                                        <div class="btn-group bootstrap-select form-control">
                                            <div class="panel-body">
                                                <label for="slAfiliadoSelect" class="sr-only">Asignar Empresas</label>
                                                <select id="slAfiliadoSelect" data-placeholder="Seleccione a los Afiliados.." multiple tabindex="4"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12 mar-btm">
                                        <label class="control-label">Comentarios</label>
                                        <textarea placeholder="Comentarios" rows="4" class="form-control" id="comentarioGestion" name="comentarioGestion" style="display: block"></textarea>
                                    </div>
                                </div>

                                <div id="msjMantGestDet"></div>

                            </div>
                        </div>
                        <button class="btn btn-sm btn-primary btn-icon btn-rounded" id="btGuardaDetalleGestionMan" disabled>Guardar Detalle de gestion mantención<i class="demo-psi-add icon-lg" style="margin-left: 10px;"></i></button>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>



@*MODAL DE GESTION*@
<div id="demo-lg-modal-new" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 13px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title"><i class="demo-psi-building icon-lg" style="margin-left: 10px;"></i>    Nueva Gestion</h4>
                <i style="float: right; margin-right: 80px; font-style: normal;  margin-top: -18px;"><i class="demo-pli-checked-user icon-lg icon-fw"></i> <span class="label label-info" id="cantAfiScheck" style="margin-right: 15px;">0</span>    Afiliados seleccionados</i>
            </div>
            <form id="form-registro-gestion" action="#" method="post">
                <div class="panel-body">
                    <div class="panel panel-bordered-primary" style="border-color: #e6e6e6;">
                        <div class="panel-body">
                            <div class="form-horizontal">

                                <div class="row">
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Estado</label>
                                        <select id="selecEstado" class="form-control" name="selecEstado">
                                            <option value="">Seleccione</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Sub-Estado</label>
                                        <select id="selecSubEstado" class="form-control" name="selecSubEstado">
                                            <option value="">Seleccione</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4 mar-btm">
                                        <label class="control-label">Fecha de compromete</label>

                                        <div id="demo-dp-component">
                                            <div class="input-group date">
                                                <input class="form-control" type="text" id="FechaGest" name="FechaGest">
                                                <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <textarea placeholder="Comentarios" rows="4" class="form-control" id="comentarioGest" name="comentarioGest"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer text-right" style="background-color: #fff;">
                    <button class="btn btn-success" id="btGuardaGestion">Guardar Gestion</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="demo-lg-modal-newAnexo" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 6px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title">    Nuevo anexo</h4>
            </div>
            <form id="form_registro_anexo" action="#" method="post">
                <div class="panel-body">
                    <div class="panel panel-bordered-primary" style="border-color: #e6e6e6;">

                        <div class="panel-body">
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Rut Empresa</label>
                                        <input type="text" class="form-control" id="txRutEmp" disabled name="txRutEmp">
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Nombre Empresa</label>
                                        <input type="text" class="form-control" id="slEmperesa_multiselect" disabled name="slEmperesa_multiselect">
                                    </div>
                                </div>

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Anexo</label>
                                        <input type="text" id="anexo" class="form-control" name="anexo">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">N° de Trabajadores</label>
                                        <input type="text" class="form-control" id="nTrajadores" name="nTrajadores">
                                    </div>
                                </div>

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Dirección</label>
                                        <input type="text" class="form-control" id="direccionAnexo" name="direccionAnexo">
                                    </div>
                                </div>

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Comuna</label>
                                        <select class="form-control" id="slComuna_multiselect" tabindex="2" name="slComuna-multiselect" required>
                                            <option value="">Seleccione</option>
                                        </select>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer text-right" style="background-color: #fff;">
                    <button class="btn btn-success" id="btGuardaEmpresa">Guardar datos empresa</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="demo-lg-modal-updateAnexo" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 6px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title">    Actualizar anexo</h4>
            </div>
            <form id="form_registro_anexoUp" action="#" method="post">
                <div class="panel-body">
                    <div class="panel panel-bordered-primary" style="border-color: #e6e6e6;">
                        <div class="panel-body">
                            <input type="text" class="form-control" id="ISeMPup" disabled name="ISeMPup" style="display: none;">
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Rut Empresa</label>
                                        <input type="text" class="form-control" id="txRutEmpUp" disabled name="txRutEmpUp">
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Nombre Empresa</label>
                                        <input type="text" class="form-control" id="slEmperesa_multiselectUp" disabled name="slEmperesa_multiselectUp">
                                    </div>
                                </div>

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Anexo</label>
                                        <input type="text" id="anexoUp" class="form-control" name="anexoUp">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">N° de Trabajadores</label>
                                        <input type="text" class="form-control" id="nTrajadoresUp" name="nTrajadoresUp">
                                    </div>
                                </div>

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Dirección</label>
                                        <input type="text" class="form-control" id="direccionAnexoUp" name="direccionAnexoUp">
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">Comuna</label>
                                        <select class="form-control" id="slComuna_multiselectUp" tabindex="2" name="slComuna-multiselectUp" required>
                                            <option value="">Seleccione</option>
                                        </select>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="checkbox">
                                        <input id="ckCargaAfi" class="magic-checkbox" type="checkbox" name="ckCargaAfi">
                                        <label for="ckCargaAfi">Cargar archivo con Afiliados</label>
                                    </div>
                                </div>
                            </div>
                            <div id="dzMain" class="dropzone demo-dropzone" style="display:none;">
                                <div class="dz-default dz-message">
                                    <div class="dz-icon">
                                        <i class="demo-pli-upload-to-cloud icon-5x"></i>
                                    </div>
                                    <div>
                                        <span class="dz-text">
                                            Haga click para seleccionar manualmente
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-footer text-right" style="background-color: #fff;">
                    <button class="btn btn-success" id="btGuardaEmpresaUp">Actualizar datos de Anexo</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="demo-lg-modal-AsigEmp" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 6px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title">    Asignación Anexo</h4>
            </div>

            <div class="panel-body">
                <div class="panel panel-bordered-primary" style="border-color: #e6e6e6;">

                    <div class="panel-body">
                        <div class="row">

                            <div class="panel-heading">
                                <h3 class="panel-title" style="font-size: 14px;">Asignar Anexos a ejecutivos</h3>
                            </div>
                            <div class="panel-body">
                                <label for="demo-inline-inputmail" class="sr-only">Asignar Empresas</label>
                                <select id="demo-cs-multiselectEje" data-placeholder="Seleccione a los ejecutivos.." multiple tabindex="4"></select>
                                <button class="btn btn-primary" id="btAsigna" type="submit">Asignar</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="overlay">
    <div id="text">Cargando Documento, por favor espera...</div>
</div>


<div id="demo-lg-modal-agenda" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 6px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title"><i class="demo-pli-calendar-4 icon-lg" style="margin-left: 10px; margin-top: -2px;"></i>   Ingreso de Citas</h4>
            </div>
            <form id="form_registro_agendaEmpresa" action="#" method="post">
                <div class="panel-body">
                    <div class="panel">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="control-label">Fecha</label>
                                        <input type="text" class="form-control" id="txtFechacita" name="txtFechacita" placeholder="Fecha" disabled>
                                    </div>
                                </div>

                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="control-label">Tipo de Visita</label>
                                        <select id="slTipoVisita" name="slTipoVisita" class="form-control" tabindex="-98">
                                            <option value="">Seleccione</option>
                                            <option value="Terreno">Terreno</option>
                                            <option value="Telefono">Telefono</option>
                                            <option value="Mail">Mail</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <textarea placeholder="Observación" style="height: 80px;" rows="13" id="txtObsCita" name="txtObsCita" class="form-control"></textarea>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div id="divPeriodico" style="display: block;">
                                <h4 id="tituloFecuencia">Frecuencia</h4>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="control-label">Sucede</label>
                                            <select id="slFrecuencia" name="slFrecuencia" class="form-control" tabindex="-98">
                                                <option value="">Seleccione</option>
                                                <option value="Diaria">Diaria</option>
                                                <option value="Semanal">Semanal</option>
                                                <option value="Quincenal">Quincenal</option>
                                                <option value="Mensual">Mensual</option>
                                            </select>
                                        </div>
                                    </div>

                                </div>
                                <hr style="margin-top: 1px;" />

                                <div style="display:block;">
                                    <div class="panel panel-bordered-info" id="divSemanal" style="display:none;">
                                        <div class="panel-body">
                                            <div class="form-group pad-ver">
                                                <label class="col-md-2 control-label" style="margin-top: 10px;  color: black;">Seleccione los dias</label>
                                                <div class="col-md-9">
                                                    <div class="checkbox">
                                                        <input id="checkbox-lunes" class="magic-checkbox" type="checkbox" name="groupCkeckDias[]" value='Lunes'>
                                                        <label for="checkbox-lunes">Lunes</label>

                                                        <input id="checkbox-martes" class="magic-checkbox" type="checkbox" name="groupCkeckDias[]" value='Martes'>
                                                        <label for="checkbox-martes">Martes</label>

                                                        <input id="checkbox-miercoles" class="magic-checkbox" type="checkbox" name="groupCkeckDias[]" value='Miércoles'>
                                                        <label for="checkbox-miercoles">Miercoles</label>

                                                        <input id="checkbox-jueves" class="magic-checkbox" type="checkbox" name="groupCkeckDias[]" value='Jueves'>
                                                        <label for="checkbox-jueves">Jueves</label>

                                                        <input id="checkbox-viernes" class="magic-checkbox" type="checkbox" name="groupCkeckDias[]" value='Viernes'>
                                                        <label for="checkbox-viernes">Viernes</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3" style="display:none;" id="divMensual">
                                            <div class="form-group">
                                                <label class="control-label">Dia</label>
                                                <select id="slDiasMensual" name="slDiasMensual" class="form-control" tabindex="-98">
                                                    <option value="">Seleccione</option>
                                                    <option value="Lunes">Lunes</option>
                                                    <option value="Martes">Martes</option>
                                                    <option value="Miércoles">Miércoles</option>
                                                    <option value="Jueves">Jueves</option>
                                                    <option value="Viernes">Viernes</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-3" style="display: none;" id="divDiario">
                                            <div class="form-group">
                                                <label class="control-label">Repetir Cada</label>
                                                <select id="slSucedeDia" name="slSucedeDia" class="form-control" tabindex="-98">
                                                    <option value="">Seleccione</option>
                                                    <option value="0">Solo una vez</option>
                                                    <option value="2">Cada 2 Dias</option>
                                                    <option value="3">Cada 3 Dias</option>
                                                    <option value="4">Cada 4 Dias</option>
                                                    <option value="1">Todos los Dias laborales</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="control-label">Comienza</label>
                                                <div class="input-group date">
                                                    <select id="slComienzaDia" name="slComienzaDia" class="form-control" tabindex="-98">
                                                        <option value="">Seleccione</option>
                                                        <option value="09:00">9:00 hrs.</option>
                                                        <option value="09:30">9:30 hrs.</option>
                                                        <option value="10:00">10:00 hrs.</option>
                                                        <option value="10:30">10:30 hrs.</option>
                                                        <option value="11:00">11:00 hrs.</option>
                                                        <option value="11:30">11:30 hrs.</option>
                                                        <option value="12:00">12:00 hrs.</option>
                                                        <option value="12:30">12:30 hrs.</option>
                                                        <option value="13:00">13:00 hrs.</option>
                                                        <option value="13:30">13:30 hrs.</option>
                                                        <option value="14:00">14:00 hrs.</option>
                                                        <option value="14:30">14:30 hrs.</option>
                                                        <option value="15:00">15:00 hrs.</option>
                                                        <option value="15:30">15:30 hrs.</option>
                                                        <option value="16:00">16:00 hrs.</option>
                                                        <option value="16:30">16:30 hrs.</option>
                                                        <option value="17:00">17:00 hrs.</option>
                                                        <option value="17:30">17:30 hrs.</option>
                                                        <option value="18:00">18:00 hrs.</option>
                                                        <option value="18:30">18:30 hrs.</option>
                                                        <option value="19:00">19:00 hrs.</option>
                                                        <option value="19:30">19:30 hrs.</option>
                                                        <option value="20:00">20:00 hrs.</option>
                                                        <option value="20:30">20:30 hrs.</option>
                                                        <option value="21:00">21:00 hrs.</option>
                                                    </select>
                                                    <span class="input-group-addon"><i class="demo-pli-clock"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="control-label">Duración</label>
                                                <div class="input-group date">
                                                    <select id="slDuracionDia" name="slDuracionDia" class="form-control" tabindex="-98">
                                                        <option value="00:30">30 Minutos</option>
                                                        <option value="01:00">1 Hora</option>
                                                        <option value="02:00">2 Horas</option>
                                                        <option value="03:00">3 Horas</option>
                                                        <option value="04:00">4 Horas</option>
                                                    </select>
                                                    <span class="input-group-addon"><i class="demo-pli-clock"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Hora finalización</label>
                                                <input type="text" class="form-control" id="txtHoraFin" name="txtHoraFin" disabled>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="panel-footer text-right" style="background-color: #fff;">
                            <button class="btn btn-success" id="btGuardaCita">Agendar Cita</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="demo-lg-modal-agenda_update" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 6px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                <h4 class="modal-title" id="nomEmpCita"><i class="demo-pli-calendar-4 icon-lg" style="margin-left: 10px; margin-top: -2px;"></i></h4>
            </div>
            <form id="form_registro_agendaEmpresa_update" action="#" method="post">
                <div class="panel-body">
                    <div class="panel">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="control-label">Fecha</label>
                                        <div id="demo-dp-component">
                                            <div class="input-group date">
                                                <input class="form-control input-group date" type="text" id="txtFechacita_update" name="txtFechacita_update">
                                                <span class="input-group-addon"><i class="demo-pli-calendar-4"></i></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="control-label">Tipo de Visita</label>
                                        <select id="slTipoVisita_update" name="slTipoVisita_update" class="form-control" tabindex="-98">
                                            <option value="">Seleccione</option>
                                            <option value="Terreno">Terreno</option>
                                            <option value="Telefono">Telefono</option>
                                            <option value="Mail">Mail</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <textarea placeholder="Observación" style="height: 80px;" rows="13" id="txtObsCita_update" name="txtObsCita_update" class="form-control"></textarea>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div id="divPeriodico_update" style="display: block;">
                                <h4 id="tituloFecuencia_update">Frecuencia</h4>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="control-label">Sucede</label>
                                            <select id="slFrecuencia_update" name="slFrecuencia_update" class="form-control" tabindex="-98" disabled>
                                                <option value="">Seleccione</option>
                                                <option value="Diaria">Diaria</option>
                                                <option value="Semanal">Semanal</option>
                                                <option value="Quincenal">Quincenal</option>
                                                <option value="Mensual">Mensual</option>
                                            </select>
                                        </div>
                                    </div>

                                </div>
                                <hr style="margin-top: 1px;" />

                                <div style="display:block;">
                                    <div class="panel panel-bordered-info" id="divSemanal_update" style="display:none;">
                                        <div class="panel-body">
                                            <div class="form-group pad-ver">
                                                <label class="col-md-2 control-label" style="margin-top: 10px;  color: black;">Seleccione los dias</label>
                                                <div class="col-md-9">
                                                    <div class="checkbox">
                                                        <input id="checkbox-lunes_update" class="magic-checkbox" type="checkbox" name="groupCkeckDias_update[]" value='Lunes' disabled>
                                                        <label for="checkbox-lunes_update">Lunes</label>

                                                        <input id="checkbox-martes_update" class="magic-checkbox" type="checkbox" name="groupCkeckDias_update[]" value='Martes' disabled>
                                                        <label for="checkbox-martes_update">Martes</label>

                                                        <input id="checkbox-miercoles_update" class="magic-checkbox" type="checkbox" name="groupCkeckDias_update[]" value='Miércoles' disabled>
                                                        <label for="checkbox-miercoles_update">Miercoles</label>

                                                        <input id="checkbox-jueves_update" class="magic-checkbox" type="checkbox" name="groupCkeckDias_update[]" value='Jueves' disabled>
                                                        <label for="checkbox-jueves_update">Jueves</label>

                                                        <input id="checkbox-viernes_update" class="magic-checkbox" type="checkbox" name="groupCkeckDias_update[]" value='Viernes' disabled>
                                                        <label for="checkbox-viernes_update">Viernes</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3" style="display:none;" id="divMensual_update">
                                            <div class="form-group">
                                                <label class="control-label">Dia</label>
                                                <select id="slDiasMensual_update" name="slDiasMensual_update" class="form-control" tabindex="-98">
                                                    <option value="">Seleccione</option>
                                                    <option value="Lunes">Lunes</option>
                                                    <option value="Martes">Martes</option>
                                                    <option value="Miércoles">Miércoles</option>
                                                    <option value="Jueves">Jueves</option>
                                                    <option value="Viernes">Viernes</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-3" style="display: none;" id="divDiario_update">
                                            <div class="form-group">
                                                <label class="control-label">Repetir Cada</label>
                                                <select id="slSucedeDia_update" name="slSucedeDia_update" class="form-control" tabindex="-98" disabled>
                                                    <option value="">Seleccione</option>
                                                    <option value="0">Solo una vez</option>
                                                    <option value="2">Cada 2 Dias</option>
                                                    <option value="3">Cada 3 Dias</option>
                                                    <option value="4">Cada 4 Dias</option>
                                                    <option value="1">Todos los Dias laborales</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="control-label">Comienza</label>
                                                <div class="input-group date">
                                                    <select id="slComienzaDia_update" name="slComienzaDia_update" class="form-control" tabindex="-98">
                                                        <option value="">Seleccione</option>
                                                        <option value="09:00">9:00 hrs.</option>
                                                        <option value="09:30">9:30 hrs.</option>
                                                        <option value="10:00">10:00 hrs.</option>
                                                        <option value="10:30">10:30 hrs.</option>
                                                        <option value="11:00">11:00 hrs.</option>
                                                        <option value="11:30">11:30 hrs.</option>
                                                        <option value="12:00">12:00 hrs.</option>
                                                        <option value="12:30">12:30 hrs.</option>
                                                        <option value="13:00">13:00 hrs.</option>
                                                        <option value="13:30">13:30 hrs.</option>
                                                        <option value="14:00">14:00 hrs.</option>
                                                        <option value="14:30">14:30 hrs.</option>
                                                        <option value="15:00">15:00 hrs.</option>
                                                        <option value="15:30">15:30 hrs.</option>
                                                        <option value="16:00">16:00 hrs.</option>
                                                        <option value="16:30">16:30 hrs.</option>
                                                        <option value="17:00">17:00 hrs.</option>
                                                        <option value="17:30">17:30 hrs.</option>
                                                        <option value="18:00">18:00 hrs.</option>
                                                        <option value="18:30">18:30 hrs.</option>
                                                        <option value="19:00">19:00 hrs.</option>
                                                        <option value="19:30">19:30 hrs.</option>
                                                        <option value="20:00">20:00 hrs.</option>
                                                        <option value="20:30">20:30 hrs.</option>
                                                        <option value="21:00">21:00 hrs.</option>
                                                    </select>
                                                    <span class="input-group-addon"><i class="demo-pli-clock"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="control-label">Duración</label>
                                                <div class="input-group date">
                                                    <select id="slDuracionDia_update" name="slDuracionDia_update" class="form-control" tabindex="-98">
                                                        <option value="00:30">30 Minutos</option>
                                                        <option value="01:00">1 Hora</option>
                                                        <option value="02:00">2 Horas</option>
                                                        <option value="03:00">3 Horas</option>
                                                        <option value="04:00">4 Horas</option>
                                                    </select>
                                                    <span class="input-group-addon"><i class="demo-pli-clock"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label class="control-label">Hora finalización</label>
                                                <input type="text" class="form-control" id="txtHoraFin_update" name="txtHoraFin_update" disabled>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="panel-footer text-right" style="background-color: #fff;">
                            <button class="btn btn-success" name="btCita_update" id="btCita_update">Modificar Cita</button>
                            <button class="btn btn-danger" name="btCita_elimina" id="btCita_elimina" type="button"> Eliminar</button>

                        </div>
                    </div>
                </div>
            </form>

        </div>
    </div>
</div>









<style>


    #overlay {
        position: fixed; /* Sit on top of the page content */
        display: none; /* Hidden by default */
        width: 100%; /* Full width (cover the whole page) */
        height: 100%; /* Full height (cover the whole page) */
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.5); /* Black background with opacity */
        z-index: 9999; /* Specify a stack order in case you're using a different order for other elements */
        cursor: pointer; /* Add a pointer on hover */
    }


    #text {
        position: absolute;
        top: 50%;
        left: 50%;
        font-size: 40px;
        color: white;
        transform: translate(-50%,-50%);
        -ms-transform: translate(-50%,-50%);
    }
</style>
@section script{
    <script src="~/Assets/plugins/dropzone/dropzone.min.js"></script>
    <script src="~/Assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
    <script src="~/Assets/plugins/chosen/chosen.jquery.min.js"></script>
    <script src="~/Assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
    <script src="~/Assets/plugins/switchery/switchery.min.js"></script>

    <script src="~/Assets/plugins/fullcalendar/lib/moment.min.js"></script>
    <script src="~/Assets/plugins/fullcalendar/lib/jquery-ui.custom.min.js"></script>
    <script src="~/Assets/plugins/fullcalendar/fullcalendar.min.js"></script>
    <script src='~/Assets/plugins/fullcalendar/lang-all.js'></script>
    <script src="~/Assets/plugins/bootbox/bootbox.min.js"></script>
    <script src="~/Assets/plugins/bootstrap-timepicker/bootstrap-timepicker.min.js"></script>


    @*<script src="~/Assets/plugins/fullcalendar/lang/es.js"></script>*@


    <script type="text/javascript">
        var rutE = httpGet('rutEmp');
        var valida = httpGet('validador');
        var ID = httpGet('Id');
        var idEmpresa = httpGet('rutEmpA');
        var RutEmpAnexo = httpGet('rutEmAnexo');
        var IJ = httpGet('IJ');
        var result = [];
        var rutAsig = []
        var idEmp = '';
        var idEnvta = 0;
        var idCabManGest = 0;
        var compromiso = 0;
        var alerta = 0;
        var alertaGestion = 0;


        $('#dateTimepk').timepicker();
        $('#dateTimeDiaria').timepicker();
        $('#dateTimeSemanal').timepicker();
        $('#dateTimeMensual').timepicker();
        $('#demo-dp-component .input-group.date').datepicker({
            format: "dd-mm-yyyy",
            autoclose: true,
            language: "es"
        }).datepicker("setDate", new Date());

        Dropzone.autoDiscover = false;
        var myDropzone = new Dropzone("div#dzMain", {
            url: "#",
            maxFiles: 1,
            uploadMultiple: false,
            maxFilesize: 15,
            acceptedFiles: '.csv'
        });
        myDropzone.on("addedfile", function (file) {
            document.getElementById("overlay").style.display = "block";
        });

        myDropzone.on("complete", function (file) {

            document.getElementById("overlay").style.display = "none";
            myDropzone.removeFile(file);
        });

        if (IJ == 0) {
            $("#tab_anexos").css('display', 'none')
            //$("#liPlanif").addClass('active')
            //$("#demo-lft-tab-1").addClass('active in')
        }


        $('#demo-lg-modal-AsigEmp').on('show.bs.modal', function (events) {
            var Anexosss = $(events.relatedTarget);
            idEmp = Anexosss.data('idemp')
            console.log(idEmp);
            $("#demo-cs-multiselectEje").val(' -').trigger("chosen:updated");
            $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-ejecutivo-asignado", { IdEmpresa: idEmp }, function (respuesta) {
                rutAsig.length = 0;
                $.each(respuesta, function (ix, ex) {
                    rutAsig[ix] = ex.RutEjecutivoAsignado
                    $('#demo-cs-multiselectEje').val(rutAsig).trigger('chosen:updated');
                });
            });
        });


        $("#demo-cs-multiselectEjeEmpresa").on("change", function (event, params) {
            if (typeof params.deselected != 'undefined') {
                // console.log('no-selectionado', params.deselected)
                var WebCarteraEmpresaAsig = {
                    Tipo: 'Empresas',
                    Id: ID,
                    EjecAsignado: params.deselected
                }
                $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/elimina-asignacion-empresa-anexo", WebCarteraEmpresaAsig, function (respuesta) {
                    if (respuesta.Estado === "OK") {
                        $.niftyNoty({
                            type: 'success',
                            container: 'floating',
                            html: '<strong>OK</strong> ' + respuesta.Mensaje,
                            focus: false,
                            timer: 2000
                        });
                    } else {
                        $.niftyNoty({
                            type: 'danger',
                            container: 'floating',
                            html: '<strong>Error</strong> ' + respuesta.Mensaje,
                            timer: 5000
                        });
                    }
                });
            }
        })

        $("#demo-cs-multiselectEje").on("change", function (event, params) {
            if (typeof params.deselected != 'undefined') {
                //console.log('no-selectionado', params.deselected)
                var WebCarteraEmpresaAsig = {
                    Tipo: 'FAnexo',
                    Id: idEmp,
                    EjecAsignado: params.deselected
                }

                $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/elimina-asignacion-empresa-anexo", WebCarteraEmpresaAsig, function (respuesta) {
                    if (respuesta.Estado === "OK") {
                        $.niftyNoty({
                            type: 'success',
                            container: 'floating',
                            html: '<strong>OK</strong> ' + respuesta.Mensaje,
                            focus: false,
                            timer: 2000
                        });
                    } else {
                        $.niftyNoty({
                            type: 'danger',
                            container: 'floating',
                            html: '<strong>Error</strong> ' + respuesta.Mensaje,
                            timer: 5000
                        });
                    }
                });
                cargador.CargaDatosAnexos();
            }
        })




        $("#btAsignaEmpresa").on("click", function () {
            var ejeAsig = [];
            $('#demo-cs-multiselectEjeEmpresa').chosen({ width: '80%' });
            $('#demo-cs-multiselectEjeEmpresa :selected').each(function () {
                ejeAsig.push($(this).val())
            });
            $.each(ejeAsig, function (i, e) {
                var WebCarteraEmpresaAsig = {
                    Tipo: 'Empresas',
                    Id: ID,
                    EjecAsignado: ejeAsig[i]
                }
                $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/guardar-asignacion-empresa-anexo", WebCarteraEmpresaAsig, function (respuesta) {
                    if (respuesta.Estado === "OK") {
                        $.niftyNoty({
                            type: 'success',
                            container: 'floating',
                            html: '<strong>OK</strong> ' + respuesta.Mensaje,
                            focus: false,
                            timer: 2000
                        });

                    } else {
                        $.niftyNoty({
                            type: 'danger',
                            container: 'floating',
                            html: '<strong>Error</strong> ' + respuesta.Mensaje,
                            timer: 5000
                        });
                    }
                    $('#demo-lg-modal-AsigEmp').modal('hide');
                });
            });
            cargador.CargaDatosAnexos();
            ejeAsig.length = 0;
        });

        $("#btAsigna").on("click", function () {
            var ejeAsig = [];
            $('#demo-cs-multiselectEje :selected').each(function () {
                ejeAsig.push($(this).val())
            });
            $.each(ejeAsig, function (i, e) {
                var WebCarteraEmpresaAsig = {
                    Tipo: 'FAnexo',
                    Id: idEmp,
                    EjecAsignado: ejeAsig[i]
                }
                $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/guardar-asignacion-empresa-anexo", WebCarteraEmpresaAsig, function (respuesta) {
                    if (respuesta.Estado === "OK") {
                        $.niftyNoty({
                            type: 'success',
                            container: 'floating',
                            html: '<strong>OK</strong> ' + respuesta.Mensaje,
                            focus: false,
                            timer: 2000
                        });

                    } else {
                        $.niftyNoty({
                            type: 'danger',
                            container: 'floating',
                            html: '<strong>Error</strong> ' + respuesta.Mensaje,
                            timer: 5000
                        });
                    }
                    $('#demo-lg-modal-AsigEmp').modal('hide');
                });
            });
            cargador.CargaDatosAnexos();
            ejeAsig.length = 0;
        });

        $('#demo-dp-component .input-group.date').datepicker({
            format: "dd/mm/yyyy",
            autoclose: true,
            language: "es"
        }).datepicker("setDate", new Date());
        $('#FechaResolucion').val('01-01-1900')

        $('#form_registro_anexo').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                anexo: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un anexo'
                        }
                    }
                },
                nTrajadores: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar N° trabajadores'
                        }
                    }
                },
                slComuna_multiselect: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar una comuna'
                        }
                    }
                },
                direccionAnexo: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar una dirección'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var $form = $(e.target);
            var idcomuna = 0;
            var objeto_envio_anexo = {
                RutEmpresa: $('#txRutEmp').val(),
                NombreEmpresa: $("#slEmperesa_multiselect").val(),
                Anexo: $('#anexo').val(),
                NumTrabajadores: $('#nTrajadores').val(),
                IdComuna: $('select[id="slComuna_multiselect"] option:selected').val(),
                NombreComuna: $('select[id="slComuna_multiselect"] option:selected').text(),
                Direccion: $('#direccionAnexo').val()
            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/ingresa-nuevo-anexo", objeto_envio_anexo, function (datos) {
                $("#form_registro_anexo").bootstrapValidator('resetForm', true);
                $('#demo-lg-modal-newAnexo').modal('hide');
                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Nuevo Anexo Creado Correctamente.',
                    container: 'floating',
                    timer: 5000
                });
                cargador.CargaDatosAnexos();
            });
        });

        $('#form_registro_anexoUp').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                anexoUp: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un anexo'
                        }
                    }
                },
                nTrajadoresUp: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar N° trabajadores'
                        }
                    }
                },
                slComuna_multiselectUp: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar una comuna'
                        }
                    }
                },
                direccionAnexoUp: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar una dirección'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var $form = $(e.target);
            var idcomuna = 0;
            var objeto_envio_anexoUp = {
                IdEmpresaAnexo: $('#ISeMPup').val(),
                Anexo: $('#anexoUp').val(),
                NumTrabajadores: $('#nTrajadoresUp').val(),
                IdComuna: $('select[id="slComuna_multiselectUp"] option:selected').val(),
                NombreComuna: $('select[id="slComuna_multiselectUp"] option:selected').text(),
                Direccion: $('#direccionAnexoUp').val()
            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/actualiza-nuevo-anexo", objeto_envio_anexoUp, function (datos) {
                $("#form_registro_anexoUp").bootstrapValidator('resetForm', true);
                $('#demo-lg-modal-updateAnexo').modal('hide');
                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Anexo Actualizado Correctamente.',
                    container: 'floating',
                    timer: 5000
                });
                cargador.CargaDatosAnexos();
            });
        });


        $('#form-registro-entrevista').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                nombContacto: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un contacto'
                        }
                    }
                },
                slEstamento: {
                    validators: {
                        notEmpty: {
                            message: 'Seleccionar un Estamento'
                        }
                    }
                },
                txtCargo: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un cargo'
                        }
                    }
                },
                txtComentariosCab: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un comentario'
                        }
                    }
                },
                tefContacto: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un Telefono'
                        }
                    }
                },
                correoContacto: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un Correo'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var $form = $(e.target);

            var rutEmpresa = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else { rutEmpresa = RutEmpAnexo }

            var objeto_envio_entrevista = {
                RutEmpresa: rutEmpresa,
                FechaEntrevista: $('#FechaGestges').val(),
                NombreContacto: $("#nombContacto").val(),
                Estamento: $('#slEstamento').val(),
                Cargo: $('#txtCargo').val(),
                Comentarios: $('#txtComentariosCab').val(),
                TelefonoContacto: $('#tefContacto').val(),
                CorreoContacto: $('#correoContacto').val(),

            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/ingresa-cabecera-entrevista", objeto_envio_entrevista, function (datos) {
                $('#btGuardaCabecera').css('display', 'none')
                $('#btGuardaDetalleEntrevista').attr('disabled', false);
                $('#form_entrevista_detalle').css('display', 'block')
                idEnvta = datos.IdEntrevista
                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Entrevista Creada Correctamente.',
                    container: '#msjEntrevistaCab',
                    timer: 5000
                });
                cargador.CargaDatosEntrevista();
            });
        });


        $('#form_entrevista_detalle').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                slTema: {
                    validators: {
                        notEmpty: {
                            message: 'Seleccionar un Tema'
                        }
                    }
                },
                slSubTema: {
                    validators: {
                        notEmpty: {
                            message: 'Seleccionar un Sub-Tema'
                        }
                    }
                },
                slSemaforo: {
                    validators: {
                        notEmpty: {
                            message: 'Seleccionar un color de Semaforo'
                        }
                    }
                },
                comentarioDtEn: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un comentario'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var $form = $(e.target);
            var objeto_detalle_entrevista = {
                IdEntrevista: idEnvta,
                Tema: $('select[id="slTema"] option:selected').text(),
                SubTema: $('select[id="slSubTema"] option:selected').text(),
                Semaforo: $('#slSemaforo').val(),
                Alerta: alerta,
                FechaResolucion: $('#FechaResolucion').val(),
                Comentarios: $('#comentarioDtEn').val(),
                Compromiso: compromiso,
            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/ingresa-detalle-entrevista", objeto_detalle_entrevista, function (datos) {
                $("#form-registro-entrevista-detalle").bootstrapValidator('resetForm', true);

                $("#slTema").val('')
                $("#slSubTema").val("")
                $("#slSemaforo").val("")
                $("#comentarioDtEn").val("")
                $("#ckCompromisoNO").prop("checked", true);
                $("#ckAlertaNO").prop("checked", true);
                compromiso = 0;
                $("#divFechaResul").css('display', 'none')
                $('#FechaResolucion').val('01-01-1900')



                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Detalle Entrevista Guardada Correctamente.',
                    container: '#msjEntrevistaDet',
                    timer: 5000
                });
            });
        });


        $('#form_gestion_mantencion').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                FechaCabeceraGest: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar una Fecha'
                        }
                    }
                },
                slTipoGestion: {
                    validators: {
                        notEmpty: {
                            message: 'Seleccionar un Tipo'
                        }
                    }
                },
                comentarioCabeceraGestion: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un comentario'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var $form = $(e.target);

            var rutEmpresa = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else { rutEmpresa = RutEmpAnexo }

            var objeto_envio_cab_gestion_man = {
                RutEmpresa: rutEmpresa,
                FechaIngreso: $('#FechaCabeceraGest').val(),
                Tipo: $("#slTipoGestion").val(),
                Comentarios: $('#comentarioCabeceraGestion').val(),
            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/ingresa-cabecera-mant-gestion", objeto_envio_cab_gestion_man, function (datos) {
                $('#btGuardaGestionMan').css('display', 'none')
                $('#btGuardaDetalleGestionMan').attr('disabled', false);
                $('#form_gestion_mantencion_detalle').css('display', 'block')
                idCabManGest = datos.IdCabGesMantencion
                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Mantencion Gestion Creada Correctamente.',
                    container: '#msjMantGestCab',
                    timer: 5000
                });
                cargador.CargaDatosGestionMan();
            });
        });


        $('#form_gestion_mantencion_detalle').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                slTema: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un Tema'
                        }
                    }
                },
                slSubTemavisita: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar una Sub-Tema'
                        }
                    }
                },
                slAfiliadoSelect: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar Afiliados'
                        }
                    }
                },
                comentarioGestion: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un comentario'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var $form = $(e.target);
            var idcomuna = 0;
            var afi = $('#slAfiliadoSelect').val()
            var afi2 = afi.join()
            var rutEmpresa = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else { rutEmpresa = RutEmpAnexo }

            var objeto_envio_gestion_mantencion = {
                IdCabGesMantencion: idCabManGest,
                RutEmpresa: rutEmpresa,
                Tema: $('select[id="slTemaGestion"] option:selected').text(),
                SubTema: $('select[id="slSubTemavisita"] option:selected').text(),
                RutAfiliado: afi2,
                Comentarios: $('#comentarioGestion').val(),
                Alerta: alertaGestion,
            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/ingresa-gestion-mantencion", objeto_envio_gestion_mantencion, function (datos) {
                $("#form_gestion_mantencion_detalle").bootstrapValidator('resetForm', true);

                $("#slTemaGestion").val('')
                $("#slSubTemavisita").val("")
                $("#ckAlertaNOGestion").prop("checked", true);
                alertaGestion = 0;
                $("#slAfiliadoSelect").val('').trigger("chosen:updated");
                $("#comentarioGestion").val("")

                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Nuevo detalle de gestion Creado Correctamente.',
                    container: '#msjMantGestDet',
                    timer: 5000
                });
            });
        });
        $('#demo-lg-modal-entrevista').on('hidden.bs.modal', function (event) {
            $('#btGuardaCabecera').css('display', 'block')
            $('#btGuardaGestionMan').css('display', 'block')
            $("#form_gestion_mantencion").bootstrapValidator('resetForm', true);
            $("#form_gestion_mantencion_detalle").bootstrapValidator('resetForm', true);
            $("#form-registro-entrevista").bootstrapValidator('resetForm', true);
            $("#form_entrevista_detalle").bootstrapValidator('resetForm', true);
            $("#slAfiliadoSelect").val('').trigger("chosen:updated");
            $("#ckAlertaNOGestion").prop("checked", true);
            $('#form_gestion_mantencion_detalle').css('display', 'none')
            $('#form_entrevista_detalle').css('display', 'none')
        });

        var cargador = {
            CargaDatosAsignadosEmp: function () {
                $("#tbOportunidad").html("");
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-asignados-empresa", { RutEmpresa: rutE }, function (menus) {
                    $.each(menus, function (i, e) {
                        $("#tbOportunidad")
                            .append(
                                $("<tr>")
                                    .append($("<td>").append(''))
                                    .append($("<td>").append(e.Id_Asign)).hide()
                                    .append($("<td>").append(e.Afiliado_Rut + '-' + e.Afiliado_Dv))
                                    .append($("<td>").append(e.Nombre + ' ' + e.Apellido))
                                    .append($("<td>").append(e.PreAprobadoFinal.toMoney() + '<span class="badge badge-success" style="float: right;">' + e.Prioridad + '</span>'))
                                    .append($("<td>").append(e.TipoCampania))
                                    .append($("<td>").append(''))
                            )
                    });
                    $("#tblAsigEmp").bootstrapTable({
                        striped: true,
                        pagination: true,
                        pageSize: 10,
                        pageList: [],
                        search: true,
                        showColumns: false,
                        showRefresh: true,
                    });
                });
            },

            CargaDatosAsignadosAnexo: function () {
                $("#tbOportunidad").html("");
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-preaprobado-anexo", { idAnexo: idEmpresa, RutEmpresa: RutEmpAnexo }, function (menus) {
                    $.each(menus, function (i, e) {
                        $("#tbOportunidad")
                            .append(
                                $("<tr>")
                                    .append($("<td>").append(''))
                                    .append($("<td>").append(e.Id_Asign)).hide()
                                    .append($("<td>").append(e.Afiliado_Rut + '-' + e.Afiliado_Dv))
                                    .append($("<td>").append(e.Nombre + ' ' + e.Apellido))
                                    .append($("<td>").append(e.PreAprobadoFinal.toMoney() + '<span class="badge badge-success" style="float: right;">' + e.Prioridad + '</span>'))
                                    .append($("<td>").append(e.TipoCampania))
                                    .append($("<td>").append(''))
                            )
                    })
                    $("#tblAsigEmp").bootstrapTable({
                        striped: true,
                        pagination: true,
                        pageSize: 10,
                        pageList: [],
                        search: true,
                        showColumns: false,
                        showRefresh: true,
                    });
                });
            },

            CargaDatosAnexos: function () {
                $("#tbdyAnexo").html("");
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-cartera-anexo", { RutEmpresa: rutE }, function (menus) {
                    var contador = 0;
                    $.each(menus, function (i, e) {
                        $("#tbdyAnexo")
                            .append(
                                $("<tr>")
                                    .append($("<td>").append(e.RutEmpresa))
                                    .append($("<td>").append('<a href="' + BASE_URL + '/motor/Emp/FichaEmpresa?rutEmpA=' + e.IdEmpresaAnexo + '&IJ=0' + '&rutEmAnexo=' + e.RutEmpresa + '" class="btn-link text-semibold" style="font-weight: 400;">' + e.Anexo + '</a>'))
                                    .append($("<td>").append('<div class="media-left pos-rel"><img class="img-circle img-sm" src="../Assets/img/profile-photos/2.png" alt="Profile Picture"><i class="badge badge-success badge-stat badge-icon pull-left">' + e.NumTrabajadores + '</i></div>'))
                                    .append($("<td>").append('<button class="btn btn-primary btn-icon btn-circle" data-target="#demo-lg-modal-updateAnexo" data-toggle="modal" data-idAnexo="' + e.IdEmpresaAnexo + '"><i class="demo-psi-pen-5 icon-xs add-tooltip" data-toggle="tooltip" data-original-title="Actualiza datos de Anexo"></i></button>'))
                                    .append($("<td>").append('<i href="#" data-toggle="modal" data-target="#demo-lg-modal-AsigEmp" data-idEmp="' + e.IdEmpresaAnexo + '"><i class="btn btn-sm demo-psi-add icon-lg" style="font-size: 31px;"></i><span class="badge badge-header badge-danger" style="position: unset;">' + e.TotalAsignados + '</span></i>'))
                            )
                    });
                });

            },
            CargaDatosEntrevista: function () {
                $("#tbdyentrevista").html("");

                var rutEmpresa = 0;
                if (rutE != "" && rutE != 'undefined' && rutE != null) {
                    rutEmpresa = rutE;
                }
                else { rutEmpresa = RutEmpAnexo }

                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-entrevista", { RutEmpresa: rutEmpresa }, function (menus) {
                    $.each(menus, function (i, e) {
                        $("#tbdyentrevista")
                            .append(
                                $("<tr>")
                                    .append($("<td>").append(e.FechaEntrevista))
                                    .append($("<td>").append("<span class='pull-center badge badge-success'>" + e.Tipo + "</span>"))
                                    .append($("<td>").append(e.NombreContacto))
                                    .append($("<td>").append(e.Cargo))
                                    .append($("<td>").append(e.Estamento))
                                    .append($("<td>").append('<a href="' + BASE_URL + '/motor/Emp/DetalleVisita?IdEntrevista=' + e.IdEntrevista + '" class="btn btn-primary btn-icon btn-circle"><i class="demo-psi-receipt-4 icon-xs"></i></a>'))
                            )
                    });

                });

            },
            CargaDatosGestionMan: function () {
                var rutEmpresa = 0;
                if (rutE != "" && rutE != 'undefined' && rutE != null) {
                    rutEmpresa = rutE;
                }
                else { rutEmpresa = RutEmpAnexo }
                $("#tbdyGestMan").html("");
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-mantencion-gestion", { RutEmpresa: rutEmpresa }, function (menus) {
                    $.each(menus, function (i, e) {
                        $("#tbdyGestMan")
                            .append(
                                $("<tr>")
                                    .append($("<td>").append(e.FechaIngreso.toFecha()))
                                    .append($("<td>").append("<span class='pull-center badge badge-success' style='width: 62px;'>" + e.Tipo + "</span>"))
                                    .append($("<td>").append(e.Comentarios))
                                    .append($("<td>").append(e.NombreEjecutivo.OrdenaNombreCompleto()))
                                    .append($("<td>").append('<a href="' + BASE_URL + '/motor/Emp/DetalleGestion?IdCabGestion=' + e.IdCabGesMantencion + '&RutEmp=' + e.RutEmpresa + '" class="btn btn-primary btn-icon btn-circle"><i class="demo-psi-receipt-4 icon-xs"></i></a>'))
                            )

                    });
                });

            },
            CargaAgenda: function (rutEmp, rutEje, idAnexo) {
                //var idEmp = 0
                //if (IJ == 0) {
                //    rutEmp = RutEmpAnexo
                //    idEmp = idAnexo
                //}

                var rutEmp = 0;
                var idEmp = 0;
                if (rutE != "" && rutE != 'undefined' && rutE != null) {
                    rutEmp = rutE;
                }
                else {
                    rutEmp = RutEmpAnexo;
                    idEmp = idEmpresa;
                }


                $('#demo-calendar').fullCalendar('destroy');
                $('#demo-calendar').fullCalendar({
                    lang: 'es',
                    header: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'month,agendaWeek,agendaDay'
                    },
                    defaultView: 'month',
                    weekends: false,
                    defaultDate: moment(),
                    eventLimit: false,
                    selectable: true,
                    selectHelper: true,
                    editable: false,
                    eventClick: function (event) {

                        $('#txtFechacita_update').val(event.start._i.toFecha())
                        $('#slTipoVisita_update').val(event.TipoVisita)
                        $('#txtObsCita_update').val(event.Glosa)
                        $('#slFrecuencia_update').val(event.Frecuencia)
                        $('#slSucedeDia_update').val(event.DiasSucede)
                        $('#slComienzaDia_update').val(event.HoraInicio)
                        $('#slDiasMensual_update').val(event.Dias)
                        $('#txtHoraFin_update').val(event.HoraFin)
                        $('#nomEmpCita').html(' Cita de Empresa:  ' + event.NombreEmpresa)

                        $("#btCita_update").data("idagenda", event.IdAgenda).data("idregistro", event.IdRegistro)
                        $("#btCita_elimina").data("idregistro", event.IdRegistro).data("idagenda", event.IdAgenda)

                        if (event.Frecuencia == 'Diaria') {
                            $("#divMensual_update").css('display', 'none')
                            $("#divSemanal_update").css('display', 'none')
                            $("#divDiario_update").css('display', 'block')
                        }
                        else if (event.Frecuencia == 'Semanal') {
                            $("#divDiario_update").css('display', 'none')
                            $("#divMensual_update").css('display', 'none')
                            $("#divSemanal_update").css('display', 'block')
                        }
                        else if (event.Frecuencia == 'Quincenal') {
                            $("#divDiario_update").css('display', 'none')
                            $("#divMensual_update").css('display', 'none')
                            $("#divSemanal_update").css('display', 'block')
                        }
                        else if (event.Frecuencia == 'Mensual') {
                            $("#divDiario_update").css('display', 'none')
                            $("#divSemanal_update").css('display', 'none')
                            $("#divMensual_update").css('display', 'block')
                        }
                        $('#demo-lg-modal-agenda_update').modal('show');

                        return false;
                    },
                    select: function (start, end) {
                        var check = moment(start).format('YYYY-MM-DD');
                        var today = moment(new Date()).format('YYYY-MM-DD');
                        if (check >= today) {
                            $("#lbEmpresaAgenda").html('Empresa : ' + $("#NombreEmpresaPer").html())
                            $('#txtFechacita').val(moment(start).format('DD-MM-YYYY'))
                            fechaPop = (moment(start).format('YYYY-MM-DD'))
                            $('#demo-lg-modal-agenda').modal('show');
                        }
                        else {

                            $.niftyNoty({
                                type: 'danger',
                                container: 'floating',
                                title: 'Error',
                                message: 'NO SE PUEDE CREAR EVENTOS ANTES DE LA FECHA ACTUAL!...',
                                closeBtn: false,
                                timer: 2800,
                            });
                        }
                    },
                    //events: '/motor/api/perfil-empresas/lista-cita-agenda-cartera/' + rutEmp + '/' + rutEje //idEmpresa
                    eventSources: [
                        {
                            url: '/motor/api/perfil-empresas/lista-cita-agenda-cartera/' + rutEmp + '/' + rutEje + '/' + idEmp,
                            type: 'GET',
                            headers: {
                                'Token': getCookie('Token')
                            },
                            success: function (i, e) {
                                if (i.length != 0) {
                                    $('#ncitas').html(i[0].Ncitas)
                                }
                                else {
                                    $('#ncitas').html('0')
                                }
                            }
                        }
                    ]
                });
                $('#demo-calendar').fullCalendar("refetchEvents");
                $('#demo-calendar').fullCalendar('render');
            }
        }

        if (rutE != "" && rutE != 'undefined' && rutE != null) {
            var rutEmpresa = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else { rutEmpresa = RutEmpAnexo }
            $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-perfil-empresa", { RutEmpresa: rutEmpresa }, function (result) {
                var NomHolding = ""
                if (result.Holding == 0) {
                    NomHolding = 'Sin Holding'
                }
                else {
                    NomHolding = result.NombreHolding
                }
                $("#tituloEmp").css('font-size', '20px').css('color', '#b3b3b3').css('margin-left', '20px')
                $("#tituloEmp").html(result.NombreEmpresa)
                $("#RutEmp").val(result.RutEmpresa)
                $("#NombreEmpresaPer").html(result.NombreEmpresa)
                $("#nTrabajadores").val(result.NTrabajador)
                $("#SegmentoEmp").val(result.Segmento)
                $("#AntiguedadA").val(result.FechaAntiguedad)
                $("#HoldingEmp").val(NomHolding)
                $("#slEmperesa_multiselect").val(result.NombreEmpresa)
                $("#txRutEmp").val(result.RutEmpresa)

                cargador.CargaDatosAsignadosEmp();
                cargador.CargaDatosAnexos();
                cargador.CargaDatosEntrevista();
                cargador.CargaDatosGestionMan();
                cargador.CargaAgenda(rutEmpresa, '0', 0);
            });
        }
        else {
            $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-perfil-empresaAnexo", { IdEmpresaA: idEmpresa }, function (result) {
                var NomHolding = ""
                if (result.Holding == 0) {
                    NomHolding = 'Sin Holding'
                }
                else {
                    NomHolding = result.NombreHolding
                }
                $("#tituloEmp").css('font-size', '20px').css('color', '#b3b3b3').css('margin-left', '20px')
                $("#tituloEmp").html(result.Anexo)
                $("#RutEmp").val(result.RutEmpresa)
                $("#NombreEmpresaPer").html(result.NombreEmpresa)
                $("#nTrabajadores").val(result.NumTrabajadores)
                $("#SegmentoEmp").val(result.Segmento)
                $("#AntiguedadA").val(result.FechaAntiguedad)
                $("#HoldingEmp").val(NomHolding)
                $("#slEmperesa_multiselect").val(result.NombreEmpresa)
                $("#txRutEmp").val(result.RutEmpresa)
            });
            cargador.CargaDatosAsignadosAnexo();
            cargador.CargaDatosEntrevista();
            cargador.CargaDatosGestionMan();
            cargador.CargaAgenda(rutEmpresa, '0', idEmpresa);
        }

        $(function () {


            $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-tipologia-gestion", { tipoCampagna: 1, padre: 0 }, function (datos) {
                $("#slTemaGestion").html("");
                $("#slTemaGestion").append($("<option>").attr("value", "").html("Seleccione"));
                $("#slTema").html("");
                $("#slTema").append($("<option>").attr("value", "").html("Seleccione"));
                $.each(datos, function (i, e) {
                    $("#slTemaGestion").append($("<option>").attr("value", e.IdTema).html(e.GlosaGestion))
                    $("#slTema").append($("<option>").attr("value", e.IdTema).html(e.GlosaGestion))
                });
            });



            $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 1, padre: 0 }, function (datos) {
                $("#selecEstado").html("");
                $("#selecEstado").append($("<option>").attr("value", "").html("Seleccione"));
                $("#selecEstado").append($("<option>").attr("value", "-1").html("Sin Gestion"));
                $.each(datos, function (i, e) {
                    $("#selecEstado").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre).data("terminal", e.ejes_terminal))
                });
            });

            $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-comunas-empresa", function (menus) {
                $("#slComuna_multiselect").html("");
                $("#slComuna_multiselectUp").html("");
                $("#slComuna_multiselect").append($("<option>").attr("value", "").html("Seleccione"));
                $("#slComuna_multiselectUp").append($("<option>").attr("value", "").html("Seleccione"));
                $.each(menus, function (i, e) {
                    $("#slComuna_multiselect").append($("<option>").attr("value", e.IdComuna).html(e.NombreComuna))
                    $("#slComuna_multiselectUp").append($("<option>").attr("value", e.IdComuna).html(e.NombreComuna))
                });
                $('#slComuna_multiselect').chosen({ width: '100%' });
                $('#slComuna_multiselectUp').chosen({ width: '100%' });
            });
            //RutEmpAnexo
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-afiliado-oficina", { RutEmpresa: rutE }, function (menus) {
                    $.each(menus, function (i, e) {
                        $("#slAfiliadoSelect").append($("<option>").attr("value", e.RutAfiliado).html(e.NombreAfiliado))
                    });
                    $('#demo-chosen-select').chosen();
                    $('#slAfiliadoSelect').chosen({ width: '100%' });
                });
            }
            else {
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-afiliado-oficina", { RutEmpresa: RutEmpAnexo }, function (menus) {
                    $.each(menus, function (i, e) {
                        $("#slAfiliadoSelect").append($("<option>").attr("value", e.RutAfiliado).html(e.NombreAfiliado))
                    });
                    $('#demo-chosen-select').chosen();
                    $('#slAfiliadoSelect').chosen({ width: '100%' });
                });
            }


            $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/dotacion-oficina", function (menus) {
                $.each(menus, function (i, e) {
                    $("#demo-cs-multiselectEje").append($("<option>").attr("value", e.Rut).html(e.Nombre + " - ( " + e.Cargo + " )"))
                    $("#demo-cs-multiselectEjeEmpresa").append($("<option>").attr("value", e.Rut).html(e.Nombre + " - ( " + e.Cargo + " )"))
                });
                $('#demo-chosen-select').chosen();
                $('#demo-cs-multiselectEje').chosen({ width: '70%' });
                $('#demo-cs-multiselectEjeEmpresa').chosen({ width: '80%' });
            });

            $('#demo-lg-modal-updateAnexo').on('show.bs.modal', function (event) {
                var Anexo = $(event.relatedTarget);
                var idAnexo = Anexo.data('idanexo')
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-datos-anexo", { IdEmpresa: idAnexo }, function (respuesta) {
                    $("#txRutEmpUp").val(respuesta.RutEmpresa)
                    $("#slEmperesa_multiselectUp").val(respuesta.NombreEmpresa)
                    $('#anexoUp').val(respuesta.Anexo)
                    $('#nTrajadoresUp').val(respuesta.NumTrabajadores)
                    $('#direccionAnexoUp').val(respuesta.Direccion)
                    $('#slComuna_multiselectUp').val(respuesta.IdComuna).trigger('chosen:updated');
                    $('#ISeMPup').val(idAnexo)
                });

                myDropzone.options.url = "/motor/api/perfil-empresas/carga-afiliados-dropzone/" + idAnexo;

                //$("div#dzMain").dropzone({ url: "/motor/api/perfil-empresas/carga-afiliados-dropzone/" + idAnexo });
                //$("div#dzMain").dropzone().destroy();

                //Dropzone.options.dropzoneForm = {
                //maxFiles: 1,
                //uploadMultiple: false,
                //maxFilesize: 15,
                //acceptedFiles: '.csv',
                //accept: function (file, done) {

                //        console.log('Accept', file)

                //        if (file.name == "justinbieber.jpg") {
                //            done("Naha, you don't.");
                //        }
                //        else { done(); }
                //    }
                //};
                //$("#dropzone-form").prop("action", "/motor/api/perfil-empresas/carga-afiliados-dropzone/" + idAnexo)
            });


            $('#demo-lg-modal-updateAnexo').on('hidden.bs.modal', function (event) {
                location.reload();
            });

            $('#slTemaGestion').change(function (e) {
                e.preventDefault();
                if ($(this).val() != '') {
                    $("#slSubTemavisita").attr("disabled", false);
                    $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-tipologia-Subgestion", { IdTema: $(this).val() }, function (datos) {
                        $("#slSubTemavisita").html("");
                        $("#slSubTemavisita").append($("<option>").attr("value", " ").html("Seleccione"));
                        $.each(datos, function (i, e) {
                            $("#slSubTemavisita").append($("<option>").attr("value", e.IdSubTema).html(e.GlosaSubTema))
                        });
                    });
                }
                else {
                    $("#slSubTemavisita").html("");
                    $("#slSubTemavisita").attr("disabled", true);
                }
            });

            $('#slTema').change(function (e) {
                e.preventDefault();
                if ($(this).val() != '') {
                    $("#slSubTema").attr("disabled", false);
                    $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-tipologia-Subgestion", { IdTema: $(this).val() }, function (datos) {
                        $("#slSubTema").html("");
                        $("#slSubTema").append($("<option>").attr("value", " ").html("Seleccione"));
                        $.each(datos, function (i, e) {
                            $("#slSubTema").append($("<option>").attr("value", e.IdSubTema).html(e.GlosaSubTema))
                        });
                    });
                }
                else {
                    $("#slSubTema").html("");
                    $("#slSubTema").attr("disabled", true);
                }
            });

            $('#selecEstado').change(function (e) {
                e.preventDefault();

                if ($(this).val() != '') {
                    $("#selecSubEstado").attr("disabled", false);
                    $.SecGetJSON(BASE_URL + "/motor/api/Gestion/lista-estados-gestion", { tipoCampagna: 1, padre: $(this).val() }, function (datos) {
                        $("#selecSubEstado").html("");
                        $("#selecSubEstado").append($("<option>").attr("value", " ").html("Seleccione"));
                        $("#selecSubEstado").append($("<option>").attr("value", "-1").html("Sin Gestión"));
                        $.each(datos, function (i, e) {
                            $("#selecSubEstado").append($("<option>").attr("value", e.eges_id).html(e.eges_nombre))
                        });
                    });
                }
                else {
                    $("#selecSubEstado").html("");
                    $("#selecSubEstado").attr("disabled", true);
                }
            });


            $('#slPeriodicidad').change(function (e) {
                e.preventDefault();
                if ($(this).val() == 0) {
                    $("#divUnaVez").css('display', 'block')
                    $("#divPeriodico").css('display', 'none')
                }
                else {

                    $("#divPeriodico").css('display', 'block')
                    $("#divUnaVez").css('display', 'none')
                }
            });

            $('#slFrecuencia').change(function (e) {
                e.preventDefault();
                if ($(this).val() == 'Diaria') {

                    $("#divSemanal").css('display', 'none')
                    $("#divMensual").css('display', 'none')
                    $("#tituloFecuencia").html('Frecuencia Diaria')
                    $("#divDiario").css('display', 'block')
                }
                else if ($(this).val() == 'Semanal') {

                    $("#divDiario").css('display', 'none')
                    $("#divMensual").css('display', 'none')
                    $("#tituloFecuencia").html('Frecuencia Semanal')
                    $("#divSemanal").css('display', 'block')
                }
                else if ($(this).val() == 'Quincenal') {

                    $("#divDiario").css('display', 'none')
                    $("#divMensual").css('display', 'none')
                    $("#tituloFecuencia").html('Frecuencia Quicenal')
                    $("#divSemanal").css('display', 'block')
                }
                else if ($(this).val() == 'Mensual') {
                    $("#divSemanal").css('display', 'none')
                    $("#divDiario").css('display', 'none')
                    $("#tituloFecuencia").html('Frecuencia Mensual')
                    $("#divMensual").css('display', 'block')
                }
            });

            $('#slFrecuencia_update').change(function (e) {
                e.preventDefault();
                if ($(this).val() == 'Diaria') {

                    $("#divSemanal_update").css('display', 'none')
                    $("#divMensual_update").css('display', 'none')
                    $("#tituloFecuencia_update").html('Frecuencia Diaria')
                    $("#divDiario_update").css('display', 'block')
                }
                else if ($(this).val() == 'Semanal') {

                    $("#divDiario_update").css('display', 'none')
                    $("#divMensual_update").css('display', 'none')
                    $("#tituloFecuencia_update").html('Frecuencia Semanal')
                    $("#divSemanal_update").css('display', 'block')
                }
                else if ($(this).val() == 'Quincenal') {

                    $("#divDiario_update").css('display', 'none')
                    $("#divMensual_update").css('display', 'none')
                    $("#tituloFecuencia_update").html('Frecuencia Quicenal')
                    $("#divSemanal_update").css('display', 'block')
                }
                else if ($(this).val() == 'Mensual') {
                    $("#divSemanal_update").css('display', 'none')
                    $("#divDiario_update").css('display', 'none')
                    $("#tituloFecuencia_update").html('Frecuencia Mensual')
                    $("#divMensual_update").css('display', 'block')
                }
            });

            var result = [];
            $('#btGestion').click(function () {
                result.length = 0;
                var i = 0;
                $("input[type=checkbox]:checked").each(function () {
                    if ($(this).parent().parent().find('td').eq(1).text() != "") {
                        result[i] = $(this).parent().parent().find('td').eq(1).text();
                        ++i;
                    }
                });
                $("#cantAfiScheck").html(result['length'])
                console.log(result);
            });

            $('#tblAsigEmp').on('check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table', function (e, row) {
                result.length = 0;
                var i = 0;
                $("input[type=checkbox]:checked").each(function () {
                    if ($(this).parent().parent().find('td').eq(1).text() != "") {
                        result[i] = $(this).parent().parent().find('td').eq(1).text();
                        ++i;
                    }
                });
                $("#cantAfiScheck").html(result['length'])
                console.log(result);
            });

            $('#radioEmpresa').on("click", function () {
                $('#tipoAsignacionAnexo').css('display', 'none')
                $('#tipoAsignacionEmpresa').css('display', 'block')
                $.SecGetJSON(BASE_URL + "/motor/api/perfil-empresas/lista-ejecutivo-asignado", { IdEmpresa: ID }, function (result) {
                    rutAsig.length = 0;
                    $.each(result, function (i, e) {
                        rutAsig[i] = e.RutEjecutivoAsignado
                        $('#demo-cs-multiselectEjeEmpresa').val(rutAsig).trigger('chosen:updated');
                    });
                });
            });

            $('#radioAnexo').on("click", function () {
                $('#tipoAsignacionEmpresa').css('display', 'none')
                $('#tipoAsignacionAnexo').css('display', 'block')
            });

            $('#ckCargaAfi').on('change', function () {
                if ($(this).is(':checked')) {
                    $('.demo-dropzone').css('display', 'block')
                }
                else {
                    $('.demo-dropzone').css('display', 'none')
                }
            });

            if (valida == 0) {
                $("#radioValidador").css('display', 'block')
            }
            else if (valida == 1) {
                $("#radioEmpresa").click();
                $("#tab_anexos").html("Asignación Empresa")
                $("#tipoAsignacionEmpresa").css('display', 'block')
                $("#radioEmpresa").click();

            }
            else if (valida == 2) {
                $("#tipoAsignacionAnexo").css('display', 'block')
            }


            $('#radioEntravista').on("click", function () {
                $('#divVisita').css('display', 'none')
                $('#divEntrevista').css('display', 'block')
            });
            $('#radioVisita').on("click", function () {
                $('#divEntrevista').css('display', 'none')
                $('#divVisita').css('display', 'block')
            });



            //$('#form-registro-gestion').bootstrapValidator({
            //    excluded: [':disabled', ':not(:visible)'],
            //    feedbackIcons: [],
            //    fields: {
            //        selecEstado: {
            //            validators: {
            //                notEmpty: {
            //                    message: 'Debe seleccionar un Estado'
            //                }
            //            }
            //        },
            //        selecSubEstado: {
            //            validators: {
            //                notEmpty: {
            //                    message: 'Debe seleccionar una sub-estado'
            //                }
            //            }
            //        },
            //        FehaGest: {
            //            validators: {
            //                notEmpty: {
            //                    message: 'La fecha compromete no puede ser vacia'
            //                },
            //                date: {
            //                    format: 'dd/mm/yyyy"',
            //                    message: 'La fecha de compromete no es valida'
            //                }
            //            }
            //        },
            //        comentarioGest: {
            //            validators: {
            //                notEmpty: {
            //                    message: 'Debe ingresar un comentario'
            //                }
            //            }
            //        }
            //    }
            //}).on('success.form.bv', function (e) {
            //    // Prevén que se mande el formulario
            //    //e.preventDefault();
            //    //var $form = $(e.target);


            //    //$.SecGetJSON(BASE_URL + "/motor/api/Contactos/ingresa-nuevo-contacto", objeto_envio_gestion, function (datos) {
            //    //    $("#form-registro-contacto").bootstrapValidator('resetForm', true);
            //    //    $('#demo-lg-modal-new').modal('hide');
            //    //    Cargador.CargaDatosContactos(rutAf)



            //    //           public int ges_estado { get; set;
            //    //    }
            //    //public int ges_subestado { get; set; }
            //    //public string ges_prox_gestion { get; set; }
            //    //public string ges_comentarios { get; set; }
            //    //public int ges_id_asignacion { get; set; }


            //    //  $.each(datos, function (i, e)

            //    $.each(result, function (i, e) {
            //        var objeto_envio_gestion = {
            //            RutAfiliado: result[e],
            //            Estado: $('select[name="selecEstado"] option:selected').text(),
            //            Subestado: $('select[name="selecSubEstado"] option:selected').text(),
            //            Comentario: $('#comentarioGest').val()
            //        }
            //        $.SecPostJSON(BASE_URL + "/motor/api/Gestion/guardar-gestion", objeto_envio_gestion, function (respuesta) {

            //            if (respuesta.Estado === 'OK') {

            //                $.niftyNoty({
            //                    type: 'success',
            //                    container: '#mensahes-must',
            //                    html: '<strong>OK</strong> Gestion guardada exitosamente.',
            //                    focus: false,
            //                    timer: 3000
            //                });
            //            } else {
            //                $.niftyNoty({
            //                    type: 'danger',
            //                    container: '#mensahes-must',
            //                    html: '<strong>Error</strong> ' + respuesta.Mensaje,
            //                    focus: false,
            //                    timer: 3000
            //                });
            //            }
            //        });
            //    });

            //    $('#btGestion').click()
            //    $.niftyNoty({
            //        type: 'success',
            //        icon: 'pli-like-2 icon-2x',
            //        message: result['length'] + '  Gestiones Guardas correctamente.',
            //        container: 'floating',
            //        timer: 5000
            //    });
            //    //});

            //});

            $("input:radio[name=groupCkeckAlertaGestion]").click(function () {
                switch (this.value) {
                    case "SI":
                        //alert(this.value);
                        alertaGestion = 1;
                        break;
                    case "NO":
                        //alert(this.value);
                        alertaGestion = 0;
                        break;
                }
            });


            $("input:radio[name=groupCkeckAlerta]").click(function () {
                switch (this.value) {
                    case "SI":
                        //alert(this.value);
                        alerta = 1;
                        //$("#divFechaResul").css('display', 'block')
                        //$("#comentarioResultado").css('display', 'block')
                        break;
                    case "NO":
                        //alert(this.value);
                        alerta = 0;
                        //$("#divFechaResul").css('display', 'none')
                        //$("#comentarioResultado").css('display', 'none')
                        break;
                }
            });

            $("input:radio[name=groupCkeckCompromiso]").click(function () {
                switch (this.value) {
                    case "SI":
                        //alert(this.value);
                        compromiso = 1;
                        $("#divFechaResul").css('display', 'block')
                        $("#comentarioResultado").css('display', 'block')
                        break;
                    case "NO":
                        //alert(this.value);
                        compromiso = 0;
                        $("#divFechaResul").css('display', 'none')
                        $("#comentarioResultado").css('display', 'none')
                        $('#FechaResolucion').val('01-01-1900')
                        break;
                }
            });
        });



        $("input:radio[name=groupCkeckAlerta_visitas]").click(function () {
            switch (this.value) {
                case "Mantenedor":
                    //alert(this.value);
                    $('.colap2').collapse('hide')
                    $('.colap1').collapse('show')

                    break;
                case "Visita":
                    $('.colap1').collapse('hide')
                    $('.colap2').collapse('show')
                    break;
            }
        });
        $('#slDuracionDia').change(function (e) {
            e.preventDefault();
            if ($(this).val() != '') {

                var Hrini = $('#slComienzaDia').val()
                var Hrfin = $('#slDuracionDia').val()
                var HriniSpl = Hrini.split(':');
                var HrfinSpl = Hrfin.split(':');
                var hora
                var minutos;
                if ((parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])) < 59) {
                    hora = parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0]);
                    minutos = parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])
                    if (minutos == 0) {
                        minutos = '00'
                    }
                }
                else {
                    hora = (parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0])) + 1;
                    minutos = '00'
                }
                var valor = hora + ':' + minutos
                $('#txtHoraFin').val(valor)
            }
        });

        $('#slComienzaDia').change(function (e) {
            e.preventDefault();
            if ($(this).val() != '') {

                var Hrini = $('#slComienzaDia').val()
                var Hrfin = $('#slDuracionDia').val()
                var HriniSpl = Hrini.split(':');
                var HrfinSpl = Hrfin.split(':');
                var hora
                var minutos;
                if ((parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])) < 59) {
                    hora = parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0]);
                    minutos = parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])
                    if (minutos == 0) {
                        minutos = '00'
                    }
                }
                else {
                    hora = (parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0])) + 1;
                    minutos = '00'
                }
                var valor = hora + ':' + minutos
                $('#txtHoraFin').val(valor)
            }
        });

        $('#slDuracionDia_update').change(function (e) {
            e.preventDefault();
            if ($(this).val() != '') {

                var Hrini = $('#slComienzaDia_update').val()
                var Hrfin = $('#slDuracionDia_update').val()
                var HriniSpl = Hrini.split(':');
                var HrfinSpl = Hrfin.split(':');
                var hora
                var minutos;
                if ((parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])) < 59) {
                    hora = parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0]);
                    minutos = parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])
                    if (minutos == 0) {
                        minutos = '00'
                    }
                }
                else {
                    hora = (parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0])) + 1;
                    minutos = '00'
                }
                var valor = hora + ':' + minutos
                $('#txtHoraFin_update').val(valor)
            }
        });

        $('#slComienzaDia_update').change(function (e) {
            e.preventDefault();
            if ($(this).val() != '') {

                var Hrini = $('#slComienzaDia_update').val()
                var Hrfin = $('#slDuracionDia_update').val()
                var HriniSpl = Hrini.split(':');
                var HrfinSpl = Hrfin.split(':');
                var hora
                var minutos;
                if ((parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])) < 59) {
                    hora = parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0]);
                    minutos = parseInt(HriniSpl[1]) + parseInt(HrfinSpl[1])
                    if (minutos == 0) {
                        minutos = '00'
                    }
                }
                else {
                    hora = (parseInt(HriniSpl[0]) + parseInt(HrfinSpl[0])) + 1;
                    minutos = '00'
                }
                var valor = hora + ':' + minutos
                $('#txtHoraFin_update').val(valor)
            }
        });


        $('#form_registro_agendaEmpresa').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                slTipoVisita: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un tipo de visita'
                        }
                    }
                },
                txtObsCita: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar glosa de la cita'
                        }
                    }
                },
                slFrecuencia: {
                    validators: {
                        notEmpty: {
                            message: 'Debe seleccionar una frecuencia'
                        }
                    }
                },
                slComienzaDia: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar una hora'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var rutEmpresa = 0;
            var IDAnexo = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else {
                rutEmpresa = RutEmpAnexo;
                IDAnexo = idEmpresa;
            }
            var $form = $(e.target);
            var results = new Array();

            results.length = 0;
            var i = 0;
            if ($('#slFrecuencia').val() == 'Semanal' || $('#slFrecuencia').val() == 'Quincenal') {
                $("input[name='groupCkeckDias[]']:checked").each(function () {
                    results[i] = '"' + $(this).val() + '"'
                    i++
                });
                results = '[' + results + ']'
            }
            else if ($('#slFrecuencia').val() == 'Mensual') {
                results = $('#slDiasMensual').val()
            }
            else if ($('#slFrecuencia').val() == 'Diaria') {
                results = "Null"
            }

            var objeto_envio_agenda_empresa = {
                RutEmpresa: rutEmpresa,
                NombreEmpresa: $('#NombreEmpresaPer').html(),
                Glosa: $('#txtObsCita').val(),
                FechaInico: fechaPop + ' ' + $('#slComienzaDia').val(),
                FechaFin: fechaPop + ' ' + $('#txtHoraFin').val(),
                HoraInicio: $('#slComienzaDia').val(),
                HoraFin: $('#txtHoraFin').val(),
                Frecuencia: $('#slFrecuencia').val(),
                Dias: results,
                TipoVisita: $('#slTipoVisita').val(),
                IdAnexo: IDAnexo,
                DiasSucede: $('#slSucedeDia').val(),
            }

            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/ingresa-cita-agenda-empresa", objeto_envio_agenda_empresa, function (datos) {
                $("#form_registro_agendaEmpresa").bootstrapValidator('resetForm', true);
                $('#demo-lg-modal-agenda').modal('hide');
                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'Se agendo la cita correctamente.',
                    container: 'floating',
                    timer: 5000
                });
                $('#demo-calendar').fullCalendar('refetchEvents');
            });
        });




        $('#form_registro_agendaEmpresa_update').bootstrapValidator({
            excluded: [':disabled', ':not(:visible)'],
            feedbackIcons: [],
            fields: {
                slTipoVisita_update: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar un tipo de visita'
                        }
                    }
                },
                txtObsCita_update: {
                    validators: {
                        notEmpty: {
                            message: 'Debe ingresar glosa de la cita'
                        }
                    }
                }
            }
        }).on('success.form.bv', function (e) {
            e.preventDefault();
            var rutEmpresa = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else { rutEmpresa = RutEmpAnexo }

            var $form = $(e.target);
            var results = new Array();
            results.length = 0;
            var i = 0;
            if ($('#slFrecuencia_update').val() == 'Semanal' || $('#slFrecuencia_update').val() == 'Quincenal') {
                $("input[name='groupCkeckDias_update[]']:checked").each(function () {
                    results[i] = '"' + $(this).val() + '"'
                    i++
                });
                results = '[' + results + ']'
            }
            else if ($('#slFrecuencia_update').val() == 'Mensual') {
                results = $('#slDiasMensual_update').val()
            }
            else if ($('#slFrecuencia_update').val() == 'Diaria') {
                results = "Null"
            }

            var objeto_envio_agenda_empresa_update = {
                IdAgenda: $("#btCita_update").data("idagenda"),
                RutEmpresa: rutEmpresa,
                Glosa: $('#txtObsCita_update').val(),
                FechaInico: $('#txtFechacita_update').val().toFecha() + ' ' + $('#slComienzaDia_update').val(),
                FechaFin: $('#txtFechacita_update').val().toFecha() + ' ' + $('#txtHoraFin_update').val(),
                HoraInicio: $('#slComienzaDia_update').val(),
                HoraFin: $('#txtHoraFin_update').val(),
                TipoVisita: $('#slTipoVisita_update').val(),
            }
            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/actualiza-cita-agenda-empresa", objeto_envio_agenda_empresa_update, function (datos) {
                $("#form_registro_agendaEmpresa_update").bootstrapValidator('resetForm', true);
                $('#demo-lg-modal-agenda_update').modal('hide');
                $.niftyNoty({
                    type: 'success',
                    icon: 'pli-like-2 icon-2x',
                    message: 'SE MODIFICO LA CITA DEL DIA CORRECTAMENTE !.',
                    container: 'floating',
                    timer: 5000
                });
                $('#demo-calendar').fullCalendar('refetchEvents');
            });
        });


        $('#btCita_elimina').on('click', function () {

            var rutEmpresa = 0;
            if (rutE != "" && rutE != 'undefined' && rutE != null) {
                rutEmpresa = rutE;
            }
            else { rutEmpresa = RutEmpAnexo }

            bootbox.dialog({
                message: "<h1 class='page-header text-overflow pad-btm'>Puede eliminar la cita del dia o la cita frecuente !</h1>",
                title: "ELIMINAR CITA",
                buttons: {
                    success: {
                        label: "Eliminar Cita del Dia",
                        className: "btn-success",
                        callback: function () {
                            var objeto_envio_agenda_empresa_eliminar = {
                                IdAgenda: $("#btCita_elimina").data("idagenda"),
                                IdRegistro: 0,
                                RutEmpresa: rutEmpresa,
                            }
                            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/elimina-cita-agenda-empresa", objeto_envio_agenda_empresa_eliminar, function (datos) {
                                $("#form_registro_agendaEmpresa_update").bootstrapValidator('resetForm', true);
                                $('#demo-lg-modal-agenda_update').modal('hide');
                                $.niftyNoty({
                                    type: 'success',
                                    icon: 'pli-like-2 icon-2x',
                                    message: 'SE ELIMINO LA CITA DEL DIA CORRECTAMENTE.',
                                    container: 'floating',
                                    timer: 5000
                                });
                                $('#demo-calendar').fullCalendar('refetchEvents');
                            });
                        }
                    },

                    danger: {
                        label: "Eliminar Cita Frecuente",
                        className: "btn-danger",
                        callback: function () {
                            var objeto_envio_agenda_empresa_eliminar = {
                                IdAgenda: 0,
                                IdRegistro: $("#btCita_elimina").data("idregistro"),
                                RutEmpresa: rutEmpresa,
                            }
                            $.SecPostJSON(BASE_URL + "/motor/api/perfil-empresas/elimina-cita-agenda-empresa", objeto_envio_agenda_empresa_eliminar, function (datos) {
                                $("#form_registro_agendaEmpresa_update").bootstrapValidator('resetForm', true);
                                $('#demo-lg-modal-agenda_update').modal('hide');
                                $.niftyNoty({
                                    type: 'success',
                                    icon: 'pli-like-2 icon-2x',
                                    message: 'SE ELIMINO LA CITA FRECUENTE CORRECTAMENTE.',
                                    container: 'floating',
                                    timer: 5000
                                });
                                $('#demo-calendar').fullCalendar('refetchEvents');
                            });
                        }
                    },
                    main: {
                        label: "Cancelar",
                        className: "btn-primary",
                    }
                }
            })
        });


    </script>

}





